"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[25862],{25862:function(e,t,o){o.d(t,{Z:function(){return dt}});var n,r,s,i,l,a,d,c,u,p,h,f,v,_,g,k,m,y,x=o(20348),I=o(88753),w=o.n(I),A=o(52198),H=o(79003),b=o(70989),F=o(58055),P=o(31428),S=o(27018),C=o(29799),O=o(93586),j=o(89703),E=o(78854),Z=o(83200),T=o(20528),L=o(39238),R=o(37024),B=o(52558),N=o(24195),D=o(32653),M=o(27644),q=o(56402),z=o(5905),U=o(10614),W=o(45835),V=o(84283),K=o(27784),G=o(98884),Y=o(16962),J=o(12006),X=o(86964),$=o(49227),Q=o(84635),ee=o(69159),te=o(5117),oe=o(38634),ne=o(30645),re=o(59087),se=o(51726),ie=o(69943),le=o(78050),ae=o(36250),de=o(17279),ce=o(39064),ue=o(83354),pe=o(77316),he=o(74857),fe=o.n(he),ve=o(86758),_e="rounded-sm cursor-pointer px-4 py-1.5 leading-6 bg-white dark:bg-dark-90 hover:bg-gray-buttonHover dark:hover:bg-gray-buttonHover",ge=function(e){var t=j.useState(null),o=(0,ne.Z)(t,2),n=o[0],r=o[1],s=(0,se.TL)(),i=(0,se.ix)((function(e){var t,o;return null===(t=e.author)||void 0===t||null===(o=t.collection)||void 0===o?void 0:o.external_offer})),l=(0,se.ix)((function(e){var t,o;return null===(t=e.author.collection.instance)||void 0===t||null===(o=t.details)||void 0===o?void 0:o.toc.categories})),a=(0,se.ix)((function(e){return e.user.courseCompletion})),d=(0,ue.ZP)(l),c=null===a||void 0===a?void 0:a["CourseCompletion_".concat(e.authorId,"_").concat(e.collectionId)],u=(0,pe.Z)(d,c).percentCompleted,p=!(null===i||void 0===i||!i.id);j.useEffect((function(){!p&&u&&e.authorId&&e.collectionId&&e.pageId&&(0,de.Gi)(e.authorId,e.collectionId,e.pageId,u).then((function(e){var t=JSON.parse(e);s(ce.X5.setExternalOffer({externalOffer:t}))})).catch((function(e){}))}),[u,s,p,e.authorId,e.collectionId,e.pageId]);var h=function(t){i.id&&(0,de.aB)(i.id,t,e.authorId,e.collectionId,u),r(null),s(ce.X5.hideExternalOffer())};if(null===i||void 0===i||!i.content||null!==i&&void 0!==i&&i.hidden)return null;var f="";if(null!==i&&void 0!==i&&i.use_utm){var v={utm_source:"educative",utm_medium:"partner",utm_campaign:fe()().format("MMMM_YYYY")},_=Object.keys(v).map((function(e){return"".concat(encodeURI(e),"=").concat(encodeURI(v[e]))}));f="".concat(_.join("&")),f=i.external_link.includes("?")?"&".concat(f):"?".concat(f)}return(0,x.jsx)(ie.df,{triggerOnce:!0,onChange:function(t){!t||null!==i&&void 0!==i&&i.viewed||((0,de.aB)(i.id,"viewed",e.authorId,e.collectionId,u),s(ce.X5.setExternalOfferViewed()))},children:(0,x.jsxs)("div",{className:"flex my-16 mx-4",children:[(0,x.jsxs)("span",{className:"text-xl mt-2",children:[null===i||void 0===i?void 0:i.content,(0,x.jsx)("a",{className:"text-primary dark:text-primary-light ml-1.5 border-0 border-b border-solid border-primary dark:border-primary-light font-semibold",onClick:function(){(0,de.aB)(i.id,"clicked",e.authorId,e.collectionId,u)},target:"_blank",rel:"noopener noreferrer",href:"".concat(null===i||void 0===i?void 0:i.external_link).concat(f),children:"See how"}),(0,x.jsx)(le.Z,{overlay:(0,x.jsxs)("p",{id:"external-offer",className:"m-0 max-w-xs text-center",children:["No data has been shared with"," ",(0,x.jsx)("strong",{children:null===i||void 0===i?void 0:i.name}),". After clicking, you will be prompted to enter your own information on their site."]}),parentClasses:"align-middle inline ml-1",position:$.YS,children:(0,x.jsx)(ae.Z,{className:"h-4 w-4"})})]}),(0,x.jsx)("div",{className:"ml-2",children:(0,x.jsxs)(ve.zx,{onRootClose:function(){return r(null)},children:[(0,x.jsx)("button",{className:"icon-default rounded-full","aria-label":"dismiss",onClick:function(t){var o=Boolean(n)?null:t.currentTarget;r(o),(0,de.aB)(i.id,"close_icon_clicked",e.authorId,e.collectionId,u)},children:(0,x.jsx)(re.Z,{className:"flex-shrink-0"})}),(0,x.jsxs)("ul",{id:"simple-menu",className:"".concat(Boolean(n)?"block":"hidden"," list-none py-2 px-0 m-0 rounded absolute bg-white dark:bg-dark-90"),style:{boxShadow:"0px 5px 5px -3px rgb(0 0 0 / 20%), 0px 8px 10px 1px rgb(0 0 0 / 14%), 0px 3px 14px 2px rgb(0 0 0 / 12%)"},children:[(0,x.jsx)("li",{className:_e,onClick:function(){h("remind_again_fourteen_days")},children:"Remind me in 2 weeks"}),(0,x.jsx)("li",{className:_e,onClick:function(){h("remind_again_month")},children:"Remind me in a month"}),(0,x.jsx)("li",{className:_e,onClick:function(){h("not_interested")},children:"Not interested"})]})]})})]})})},ke=o(22894);function me(){return(me=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e}).apply(this,arguments)}var ye=function(e){return j.createElement("svg",me({width:160,height:189,viewBox:"0 0 160 189",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),n||(n=j.createElement("path",{d:"M96.8 2.3c17.8 0 32.4 13.7 38.4 26.5 5.6 11.7 5.6 24.4 5.6 35.6v40.7c0 5.6-4.1 10-9 10s-9-4.4-9-10V64.4c0-9.7 0-18.9-3.5-26.2-3.6-7.7-12.8-15.9-22.5-15.9a30 30 0 00-24 11.3A42.8 42.8 0 0064.3 64c.4 5.5-3.2 10.4-8.2 11h-.8c-4.6 0-8.5-4-9-9.2A64.5 64.5 0 0159.6 20 47.3 47.3 0 0196.8 2.2zm0-2.3a49.6 49.6 0 00-39 18.6A66.7 66.7 0 0044.1 66c.2 3 1.5 5.8 3.5 8a10.6 10.6 0 007.7 3.2h1c6.2-.7 10.8-6.7 10.2-13.4-.9-11 2-21.4 8-28.8a27.8 27.8 0 0122.3-10.4c8.8 0 17.1 7.5 20.5 14.6a61.2 61.2 0 013.2 25.2v40.7c0 6.8 5 12.3 11.3 12.3S143 112 143 105.1V64.4c0-11.4 0-24.4-5.7-36.6C130.9 14.4 115.5 0 96.8 0z",fill:"#333"})),r||(r=j.createElement("path",{d:"M131.8 115.2c-5 0-9-4.5-9-10.1V64.4c0-9.7 0-18.9-3.5-26.2-3.6-7.7-12.8-15.9-22.5-15.9s-18 4-24 11.3A42.8 42.8 0 0064.3 64c.4 5.5-3.2 10.4-8.2 11-5 .4-9.3-3.6-9.7-9.2A64.4 64.4 0 0159.6 20 47.3 47.3 0 0196.8 2.2c17.8 0 32.4 13.8 38.4 26.6 5.6 11.7 5.6 24.4 5.6 35.6v40.7c0 5.6-4 10-9 10z",fill:"#F3715D"})),s||(s=j.createElement("path",{d:"M155.7 91.8H35.6a2 2 0 00-2 2v90c0 1.2.9 2.1 2 2.1h120.1a2 2 0 002-2v-90a2 2 0 00-2-2z",fill:"#8887FF"})),i||(i=j.createElement("path",{d:"M157.8 93.9v1.7a4.3 4.3 0 00-.6 0H48.8A9.7 9.7 0 0039 105v70.3h-5.4v-80-.2c-.5-3.4 1.4-3.5 3.3-3.4h118.8a2 2 0 012 2z",fill:"#CCCBFF"})),l||(l=j.createElement("path",{opacity:.22,d:"M157.8 95.6v88.3a2 2 0 01-2 2H35.5a2 2 0 01-1.4-.6 2 2 0 01-.6-1.4v-8.5H137a9.5 9.5 0 009.5-9.5V95.6h11.2z",fill:"#000"})),a||(a=j.createElement("path",{d:"M155.7 91.8a2 2 0 012 2v90a2 2 0 01-2 2.1h-120a2 2 0 01-2-1.3 2 2 0 01-.1-.7v-90a2 2 0 012-2h120.1zm0-2.2h-120a4.3 4.3 0 00-4.4 4.3v90a4.3 4.3 0 004.3 4.2h120.1a4.3 4.3 0 003-1.2 4.3 4.3 0 001.3-3v-90a4.3 4.3 0 00-4.3-4.3z",fill:"#333"})),d||(d=j.createElement("g",{opacity:.24,fill:"#000"},j.createElement("path",{opacity:.24,d:"M64.2 57a41 41 0 018.6-23.4c6-7.4 14.3-11.3 24-11.3s18.9 8.2 22.5 15.9a56.9 56.9 0 013.4 24v-3.8c0-9.7 0-18.9-3.4-26.2-3.6-7.7-12.8-15.8-22.5-15.8a30 30 0 00-24 11.2A42.7 42.7 0 0064.2 57zm-17.9 8.8c.5 5.5 4.9 9.6 9.8 9.1 5-.5 8.6-5.4 8.2-11a34.4 34.4 0 01-.2-3c-.7 4.3-3.9 7.6-8 8-5 .6-9.3-3.5-9.8-9l-.1-3c-.2 3 0 6 .1 9z"}))),c||(c=j.createElement("path",{opacity:.35,d:"M46.1 61.4a63 63 0 0113.4-37.8A47.3 47.3 0 0196.8 5.8c17.7 0 32.3 13.8 38.4 26.5 5 10.5 5.5 21.8 5.5 32.1 0-11.2 0-24-5.5-35.6-6-12.8-20.7-26.6-38.4-26.6A47.3 47.3 0 0059.5 20a64 64 0 00-13.4 41.4z",fill:"#fff"})),u||(u=j.createElement("path",{d:"M97.7 141l2.8 15.8H88.2l2.5-15.8a10.3 10.3 0 01-6.7-11.4 10.3 10.3 0 0116.7-6.1 10.3 10.3 0 01-3 17.5z",fill:"#8887FF"})),p||(p=j.createElement("path",{d:"M92.3 140.8l-2.6 16h-1.5l2.5-15.8a10.3 10.3 0 01-6.7-11.4 10.3 10.3 0 0110.1-8.5h.6a10.1 10.1 0 00-9.6 10.2c0 4.5 3.2 8 7.2 9.5z",fill:"#CCCBFF"})),h||(h=j.createElement("path",{d:"M97.7 141l2.8 15.8H88.2v-.6H98l-2.8-15.7a10.2 10.2 0 004.7-15.8 10.2 10.2 0 00-5-3.6 10.2 10.2 0 019.5 10.2 10.3 10.3 0 01-6.7 9.7z",fill:"#2320CC"})),f||(f=j.createElement("path",{d:"M94.1 121.1a10.3 10.3 0 013.6 19.9l2.8 15.8H88.2l2.5-15.8a10.3 10.3 0 013.4-20v.1zm0-2.3a12.5 12.5 0 00-12 9.5 12.5 12.5 0 006 14l-2.1 14a2.3 2.3 0 002.2 2.7h12.3a2.2 2.2 0 001.7-.8 2.3 2.3 0 00.5-1.9l-2.5-14a12.5 12.5 0 00-6-23.5z",fill:"#333"})),v||(v=j.createElement("path",{d:"M28 34.5a3.1 3.1 0 00-5.8 2.4L30 55.7a3.1 3.1 0 005.8-2.5l-8-18.7z",fill:"#F3715D"})),_||(_=j.createElement("path",{opacity:.25,d:"M34.2 57.3a3 3 0 01-1.8.2 3.1 3.1 0 002.3-4.3l-8-18.7a3.1 3.1 0 00-2.3-2 3.1 3.1 0 013.5 2l8 18.7a3.1 3.1 0 01-1.7 4.1z",fill:"#fff"})),g||(g=j.createElement("path",{d:"M7 53.3A3.1 3.1 0 104.4 59l18.4 8.7a3.1 3.1 0 002.7-5.7L7 53.3z",fill:"#F3715D"})),k||(k=j.createElement("path",{opacity:.25,d:"M27 66.2a3 3 0 01-1.2 1.3 3.1 3.1 0 00-1.3-4.6L6.1 54.2a3.1 3.1 0 00-3 .2 3.1 3.1 0 014-1L25.4 62a3.1 3.1 0 011.5 4.2z",fill:"#fff"})),m||(m=j.createElement("path",{d:"M3 81.8a3.1 3.1 0 002 6l19.3-6.4a3.1 3.1 0 00-2-6L3 81.8z",fill:"#F3715D"})),y||(y=j.createElement("path",{opacity:.25,d:"M26.4 78a3.1 3.1 0 00-3.7-1.3L3.4 83a3.1 3.1 0 00-2.2 2.6 3 3 0 000 .7 3 3 0 01-.2-.6 3.1 3.1 0 012-4l19.3-6.3a3.1 3.1 0 014 2l.1.7z",fill:"#fff"})))},xe=o(96107),Ie=o(64977),we=o.n(Ie),Ae=o(786),He=o.n(Ae),be=o(46845),Fe=o.n(be),Pe=o(27913),Se=o(37636),Ce=o(97242),Oe=o(87455),je=o(56445),Ee=o(73647);function Ze(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Te(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Ze(Object(o),!0).forEach((function(t){(0,O.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Ze(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function Le(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=(0,C.Z)(e);if(t){var r=(0,C.Z)(this).constructor;o=Reflect.construct(n,arguments,r)}else o=n.apply(this,arguments);return(0,S.Z)(this,o)}}function Re(e){var t;return null===e||void 0===e||null===(t=e.userInfo)||void 0===t?void 0:t.user_id}var Be=function(e){(0,P.Z)(o,e);var t=Le(o);function o(){var e;(0,H.Z)(this,o);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r)),(0,O.Z)((0,F.Z)(e),"state",{removedCustomStyledContent:null,showAllAskForHelps:!1,showAskForHelpRaise:!1,askForHelpIndex:0,loadedSelections:{},coordsLoaded:!1,coordTop:0,coordLeft:0,askForHelpTaskId:null,askForHelps:{},sortedBlockers:[],updateBlocker:!1}),(0,O.Z)((0,F.Z)(e),"viewBlockersBtn",j.createRef()),(0,O.Z)((0,F.Z)(e),"contentData",j.createRef()),(0,O.Z)((0,F.Z)(e),"setAskForHelpIndex",(function(t){e.state.askForHelpIndex!==t&&e.setState({askForHelpIndex:t})})),(0,O.Z)((0,F.Z)(e),"handleContentBlockerClick",(function(t){var o=e.state.sortedBlockers;if(o.length>0&&!e.state.showAllAskForHelps){var n=o.findIndex((function(e){return e.id===t}));n>=0&&e.setState({askForHelpIndex:n,showAllAskForHelps:!0})}})),(0,O.Z)((0,F.Z)(e),"handleTaskBlockerState",(function(t){return e.setState({askForHelpTaskId:t})})),(0,O.Z)((0,F.Z)(e),"setShowAskForHelpRaise",(function(t){e.state.showAskForHelpRaise!==t&&e.setState({showAskForHelpRaise:t})})),(0,O.Z)((0,F.Z)(e),"setShowAllAskForHelps",(function(t){e.state.showAllAskForHelps!==t&&e.setState({showAllAskForHelps:t})})),(0,O.Z)((0,F.Z)(e),"setUpdateBlocker",(function(t){e.state.updateBlocker!==t&&e.setState({updateBlocker:t})})),(0,O.Z)((0,F.Z)(e),"prepareWidgetToCopy",(function(t){var o={index:0,data:Te(Te({},e.props.comps.find((function(e){var o=e.hash;return t===o}))),{},{mode:"view"}),parentHash:"0"};return((o=He()(o,{data:{content:{comp_id:{$set:null}}}})).data.iteration||o.data.iteration>=0)&&(o=He()(o,{data:{$unset:["iteration"]}})),(o.data.hash||o.data.hash>=0)&&(o=He()(o,{data:{$unset:["hash"]}})),Fe().AES.encrypt(JSON.stringify(o),$.Y4).toString()})),(0,O.Z)((0,F.Z)(e),"copyWidgetEvent",(function(t){var o=e.props.dispatch,n=e.prepareWidgetToCopy(t);we()(n),o(W.Vy.copy(n))})),(0,O.Z)((0,F.Z)(e),"areViewerCompsDirty",(function(){return e.props.dispatch(Pe.oh.areViewerCompsDirty())})),(0,O.Z)((0,F.Z)(e),"closeHandler",(function(t){return t.preventDefault(),!e.areViewerCompsDirty()||(t.returnValue=$.pp)})),(0,O.Z)((0,F.Z)(e),"handleContentSelect",(function(t){if(!e.state.coordsLoaded&&t){var o=e.viewBlockersBtn.current,n=e.contentData.current;if(o&&n&&e.state.showAskForHelpRaise)return e.setState({coordTop:o.offsetTop+o.offsetParent.offsetTop+35,coordLeft:o.offsetLeft+360>n.offsetWidth?n.offsetLeft+n.offsetWidth-360:o.offsetLeft<0?0:o.offsetLeft,coordsLoaded:!0}),o.scrollIntoView({behavior:"smooth",block:"center",inline:"center"}),!0;if(t[e.state.askForHelpIndex].type===je.jt.CONTENT){var r,s=null;if(Object.values(null!==(r=e.state.loadedSelections)&&void 0!==r?r:{}).forEach((function(o){Object.values(o).forEach((function(o){o.askForHelpId===t[e.state.askForHelpIndex].id&&(s=o)}))})),s){var i=document.querySelector("[data-id='".concat(s.id,"']"));if(i)return e.setState({coordTop:i.offsetTop+i.offsetParent.offsetTop+25,coordLeft:i.offsetLeft+360>i.offsetParent.offsetWidth?i.offsetParent.offsetLeft+i.offsetParent.offsetWidth-360:i.offsetLeft+i.offsetParent.offsetLeft,coordsLoaded:!0}),i.scrollIntoView({behavior:"smooth",block:"center",inline:"center"}),!0}}o&&n&&(e.setState({coordTop:o.offsetTop+o.offsetParent.offsetTop+35,coordLeft:o.offsetLeft+360>n.offsetWidth?n.offsetLeft+n.offsetWidth-360:o.offsetLeft<0?0:o.offsetLeft,coordsLoaded:!0}),o.scrollIntoView({behavior:"smooth",block:"center",inline:"center"}))}return!0})),(0,O.Z)((0,F.Z)(e),"loadSelections",(function(t){var o=[];Object.values(null!==t&&void 0!==t?t:{}).forEach((function(e){var t;null!==e&&void 0!==e&&null!==(t=e.userdata)&&void 0!==t&&t.selections&&Object.assign(o,e.userdata.selections)})),e.setState({loadedSelections:o})})),(0,O.Z)((0,F.Z)(e),"askForHelpCreate",(function(){var t,o,n,r=e.props.router,s=null===(t=e.props.collection)||void 0===t||null===(o=t.instance)||void 0===o||null===(n=o.details)||void 0===n?void 0:n.organization_id,i=r.query,l=i.author_id,a=i.collection_id,d=i.page_id;if(!e.state.askForHelpTaskId){var c=e.viewBlockersBtn.current,u=e.contentData.current;return(0,x.jsx)(ve.zx,{onRootClose:function(){e.setState({showAskForHelpRaise:!1,showAllAskForHelps:!1})},children:(0,x.jsx)("div",{className:"h-auto absolute flex shadow-lg z-10 bg-white dark:bg-dark-90",style:{top:c.offsetTop+c.offsetParent.offsetTop+35,left:c.offsetLeft+360>u.offsetWidth?u.offsetLeft+u.offsetWidth-360:c.offsetLeft<0?0:c.offsetLeft,width:"360px"},children:(0,x.jsx)(Oe.default,{params:{callBacks:{successCallBack:function(t){var o=JSON.parse(t).askforhelp_id;e.setState({askForHelpTaskId:o,showAskForHelpRaise:!1,showAllAskForHelps:!1}),e.loadAskForHelps(),e.props.dispatch(Y.n.show(J.zN,{title:"Ask For Help has been raised",description:"We have informed your mentor that you would like help with this task. You'll hear back from them soon. Meanwhile, you can explore other tasks.",styleType:"leftAligned",noButtons:!0})),(0,Se.qP)(Se.f2.ONBOARDING,Se.bt.ASK_FOR_HELP)},failureCallBack:function(){e.props.dispatch(Y.n.show(J.ad,{status:"ERROR",text:"Unable to request for Ask For Help"}))}},buttonText:"Ask For Help",buttonLoadingText:"Asking...",placeholder:"Describe the problem you are experiencing, and what kind of help you need.",successMessage:"Ask For Help request sent.",allowInput:!0,characterLimit:600,url:"/api/askforhelpV2",type:"POST",showArrows:!1,data:{author_id:l,collection_id:a,page_id:d,path_author_id:r.query.path_author_id,path_id:r.query.path_id,organization_id:s},feedbackRequired:!0,showAskForHelpRaise:e.state.showAskForHelpRaise,setShowAskForHelpRaise:function(t){return e.setShowAskForHelpRaise(t)},setShowAllAskForHelps:function(t){return e.setShowAllAskForHelps(t)}}})})})}})),(0,O.Z)((0,F.Z)(e),"loadAskForHelps",(function(){var t,o;if((null===(t=e.props.planInfo)||void 0===t?void 0:t.isPlanLesson)||(null===(o=e.props.planInfo)||void 0===o?void 0:o.isPlanModule)){var n,r,s,i=e.props.router,l=null===(n=e.props.collection)||void 0===n||null===(r=n.instance)||void 0===r||null===(s=r.details)||void 0===s?void 0:s.organization_id,a=Re(e.props),d=i.query,c=d.author_id,u=d.collection_id,p=d.page_id,h=i.query.path_author_id,f=i.query.path_id,v=i.query.menteeId;if(!v&&!a)return;(0,V.Z)({url:"/api/askforhelpV2/".concat(l,"/").concat(v||a,"/").concat(c,"/").concat(u,"/").concat(p).concat(h?"?plan_author_id=".concat(h,"&plan_id=").concat(f):""),type:"GET"}).then((function(t){e.setState({askForHelps:JSON.parse(t)})}))}})),(0,O.Z)((0,F.Z)(e),"countActiveBlockers",(function(){var t;return Object.values(null!==(t=e.state.askForHelps)&&void 0!==t?t:{}).filter((function(e){return e.status===je.JH.INITIATED})).length})),(0,O.Z)((0,F.Z)(e),"sortBlockers",(function(){var t,o=[],n=[],r=[],s=[],i=[];return Object.values(null!==(t=e.state.askForHelps)&&void 0!==t?t:{}).forEach((function(e){e.type===je.jt.TASK?e.status===je.JH.INITIATED?r.push(e):n.push(e):e.status===je.JH.INITIATED?i.push(e):s.push(e)})),o=o.concat(r,n,i,s)})),e}return(0,b.Z)(o,[{key:"componentDidMount",value:function(){var e=this;Z.default.router.change=function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return!e.areViewerCompsDirty()||window.confirm($.pp)?Z.Router.prototype.change.apply(Z.default.router,o):new Promise((function(e,t){return e(!1)}))},window.addEventListener("beforeunload",this.closeHandler),this.loadAskForHelps()}},{key:"componentDidUpdate",value:function(e,t){var o=this;if(this.state.askForHelpIndex===t.askForHelpIndex&&this.state.showAllAskForHelps===t.showAllAskForHelps||this.setState({coordsLoaded:!1,updateBlocker:!1}),e.pageProps.ask_for_help_id!==this.props.pageProps.ask_for_help_id&&this.setState({askForHelpTaskId:this.props.pageProps.ask_for_help_id}),e.router.query.page_id===this.props.router.query.page_id&&e.router.query.page_url_slug===this.props.router.query.page_url_slug&&Re(this.props)===Re(e)||(this.setShowAllAskForHelps(!1),this.setShowAskForHelpRaise(!1),this.setAskForHelpIndex(0),this.loadAskForHelps()),e.widgetSnapshots!==this.props.widgetSnapshots&&this.loadSelections(this.props.widgetSnapshots),t.askForHelps!==this.state.askForHelps)if(this.state.sortedBlockers.length>0){var n=this.state.sortedBlockers[this.state.askForHelpIndex].id,r=this.sortBlockers(this.state.askForHelps);this.setState({sortedBlockers:r},(function(){var e=r.findIndex((function(e){return e.id===n}));o.setAskForHelpIndex(e)}))}else{var s=this.sortBlockers(this.state.askForHelps);this.setState({sortedBlockers:s})}}},{key:"componentWillUnmount",value:function(){window.removeEventListener("beforeunload",this.closeHandler),delete Z.default.router.change}},{key:"render",value:function(){var e,t,o,n,r,s,i,l,a,d,c,u,p,h,f,v,_,g=this,k=this.props,m=k.pageId,y=k.authorId,I=k.collectionId,w=k.isVersionsPage,A=k.comps,H=k.docker,b=k.pageTitle,F=k.pageSummary,P=k.children,S=k.author,C=k.isCollectionArticle,O=k.widgetSnapshots,j=k.previousNextArticles,E=k.contentLoading,Z=k.userId,T=k.pageProps,L=k.default_themes,R=k.collapsed,B=k.coverImage,N=k.logWidgetInteraction,D=k.executionMetadata,M=k.userThemes,q=k.vimMode,z=k.contentWidth,U=k.course_url_slug,W=k.apiKeys,V=k.userApiKeys,ne=k.handleSaveWidgetUserData,re=k.collection,se=k.planInfo,ie=k.planPreviousNextContent,le=k.isMobileAgent,ae=k.router,de=k.isStandaloneModule,ce=k.moduleCategories,ue=this.state,pe=ue.coordTop,he=ue.coordLeft,fe=null!==(e=null===ce||void 0===ce||null===(t=ce.data)||void 0===t?void 0:t.optionalItems)&&void 0!==e?e:[],_e=fe.includes("".concat(y,"_").concat(I))||fe.includes("".concat(y,"_").concat(I,"_").concat(m)),me=null===(o=this.props.collection)||void 0===o||null===(n=o.instance)||void 0===n?void 0:n.details,Ie=null===me||void 0===me?void 0:me.path_author_id,we=null===me||void 0===me?void 0:me.path_id,Ae=(null===se||void 0===se?void 0:se.isPlanLesson)||(null===se||void 0===se?void 0:se.isPlanModule),He=Ae&&ae.query.menteeId,be={},Fe=(null===me||void 0===me?void 0:me.next_content_type)===$.j1.STANDALONE_ASSESSMENT;null!==me&&void 0!==me&&me.next_module_collection_id&&!Fe&&(be={nextModuleCollectionId:null===me||void 0===me?void 0:me.next_module_collection_id,nextModuleAuthorId:null===me||void 0===me?void 0:me.next_module_author_id,nextModuleTitle:null===me||void 0===me?void 0:me.next_module_title,nextModuleSlug:null===me||void 0===me?void 0:me.next_module_slug}),(null!==me&&void 0!==me&&me.next_external_assessment||null!==me&&void 0!==me&&me.next_external_project||Fe)&&(be={nextPathItemId:Fe?null===me||void 0===me?void 0:me.next_content_id:null===me||void 0===me?void 0:me.next_path_item_id,pathId:Fe?null===me||void 0===me?void 0:me.next_content_collection_id:we,authorId:Fe?null===me||void 0===me?void 0:me.next_content_author_id:Ie,pathUrlSlug:null===me||void 0===me?void 0:me.path_url_slug,nextModuleTitle:null===me||void 0===me?void 0:me.next_module_title,type:me.next_content_type});var Pe,Ce,Ze,Le=null===j||void 0===j?void 0:j.is_current_page_lesson,Be=T.course_title||(null===re||void 0===re||null===(r=re.instance)||void 0===r?void 0:r.details.title)||"",Ne="".concat(b||F.title||""," ").concat(Le?"- "+Be:"")||"Educative | Untitled",De=T.external_author_id,Me=T.external_collection_id,qe=T.external_page_id,ze=De&&Me&&qe?"https://www.educative.io/collection/page/".concat(De,"/").concat(Me,"/").concat(qe):null,Ue=T.page_table_of_content,We=y,Ve=I,Ke=m,Ge={};(null===(s=this.props.pageProps)||void 0===s?void 0:s.item_type)===$.RI.LESSON&&(We=null===(Pe=this.props.pageProps)||void 0===Pe?void 0:Pe.external_author_id,Ve=null===(Ce=this.props.pageProps)||void 0===Ce?void 0:Ce.external_collection_id,Ke=null===(Ze=this.props.pageProps)||void 0===Ze?void 0:Ze.external_page_id,Ge={authorId:y,collectionId:I,pageId:m,compAuthorId:We,compCollectionId:Ve,compPageId:Ke});var Ye=null===(i=this.props.cookies)||void 0===i||null===(l=i.get("theme"))||void 0===l?void 0:l.includes("dark"),Je=!(null!==(a=this.props.collection)&&void 0!==a&&a.instance.details.allow_custom_styling_viewer_side)&&Ye,Xe=!(null===(d=this.props.pageProps)||void 0===d||!d.mentor_id)&&!ae.query.menteeId,$e=null===ae||void 0===ae?void 0:ae.query.menteeId,Qe=!(null===(c=this.props.pageProps)||void 0===c||!c.is_mentor),et=this.state.sortedBlockers,tt=null===(u=this.props.collection)||void 0===u||null===(p=u.instance)||void 0===p||null===(h=p.details)||void 0===h?void 0:h.organization_id,ot=(0,Ee.i5)(this.props.userInfo,tt),nt=(0,Ee.eU)(this.props.userInfo,tt),rt=this.state.sortedBlockers,st=this.countActiveBlockers(),it=Object.keys(null!==(f=this.state.askForHelps)&&void 0!==f?f:{}).length,lt=(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(Q.Z,{renderMode:"viewer",comps:Je?this.state.removedCustomStyledContent:A,updateContentState:function(){},docker:H,allowLoggedOutExecutions:null===me||void 0===me?void 0:me.allow_logged_out_executions,uniqueLiveWidgetUrls:null===me||void 0===me?void 0:me.unique_live_widget_urls,saveWidgetUserData:ne,widgetSnapshots:O,authorId:We,userId:Z,pageId:Ke,collectionId:Ve,isDraft:w,default_themes:L,logWidgetInteraction:I&&N(w),userThemes:M,vimMode:q,executionMetadata:D,apiKeys:W,userApiKeys:V,pageType:$.sL.COLLECTION,componentVisibilityChange:this.props.componentVisibilityChange,defaultCourseLanguage:this.props.defaultCourseLanguage,originalPageProps:Ge,copyWidgetEvent:this.copyWidgetEvent,isPlan:Ae,askForHelp:this.state.askForHelps,loadAskForHelps:this.loadAskForHelps,organizationId:tt,isMentee:Xe,menteeId:$e,askForHelpIndex:this.state.askForHelpIndex,contentData:this.contentData,handleContentBlockerClick:this.handleContentBlockerClick}),Ae&&(0,x.jsx)("div",{children:this.state.showAllAskForHelps&&et.length>0&&this.handleContentSelect(et)&&(0,x.jsx)(ve.zx,{onRootClose:function(){g.setState({showAskForHelpRaise:!1,showAllAskForHelps:!1,updateBlocker:!1})},children:(0,x.jsx)("div",{className:"h-auto flex absolute flex-col shadow-lg z-10 bg-white dark:bg-dark-90",style:{top:pe,left:he,width:"360px"},children:et[this.state.askForHelpIndex].status===je.JH.RESOLVED?(0,x.jsx)(Oe.default,{params:{title:"Blockers",ask_message:et[this.state.askForHelpIndex].message||"Hi, I am stuck. Please help.",resolve_message:et[this.state.askForHelpIndex].resolved_message||"The query is resolved offline.",user_name:et[this.state.askForHelpIndex].user_name,resolver_name:et[this.state.askForHelpIndex].resolver_name,user_profile:et[this.state.askForHelpIndex].user_profile,resolver_profile:et[this.state.askForHelpIndex].resolver_profile,created:et[this.state.askForHelpIndex].created,resolved_at:et[this.state.askForHelpIndex].resolved_at,noButtons:!0,allowInput:!1,showArrows:!0,showAskForHelpRaise:this.state.showAskForHelpRaise,setShowAskForHelpRaise:function(e){return g.setShowAskForHelpRaise(e)},setShowAllAskForHelps:function(e){return g.setShowAllAskForHelps(e)},currentBlocker:this.state.askForHelpIndex,totalBlockers:et.length,setAskForHelpIndex:function(e){e>0?g.setAskForHelpIndex(g.state.askForHelpIndex+1>=et.length?0:g.state.askForHelpIndex+1):g.setAskForHelpIndex(g.state.askForHelpIndex-1<0?et.length-1:g.state.askForHelpIndex-1)}}}):(0,x.jsx)(Oe.default,{params:{callBacks:{successCallBack:function(){if(g.state.updateBlocker)g.setUpdateBlocker(!1);else{var e;g.props.dispatch(Y.n.show(J.zN,{title:"Ask For Help has been resolved",styleType:"leftAligned",noButtons:!0}));var t,o=null;if(Object.values(null!==(e=g.state.loadedSelections)&&void 0!==e?e:{}).forEach((function(e){Object.values(e).forEach((function(e){e.askForHelpId===et[g.state.askForHelpIndex].id&&(o=e)}))})),et[g.state.askForHelpIndex].type===je.jt.TASK&&g.setState({askForHelpTaskId:null}),o)null===(t=document.querySelector("[data-id='".concat(o.id,"']")).classList)||void 0===t||t.replace("markdown_viewer_highlighted_content_with_ask_for_help_unresolved","markdown_viewer_highlighted_content_with_ask_for_help_resolved");(0,Se.qP)(Se.f2.ONBOARDING,Se.bt.ASK_FOR_HELP_RESOLVED),g.setState({showAskForHelpRaise:!1,showAllAskForHelps:!1})}g.loadAskForHelps()},failureCallBack:function(){g.setUpdateBlocker(!1),g.props.dispatch(Y.n.show(J.ad,{status:"ERROR",text:"Unable to resolve for Ask For Help"}))}},title:"Blockers",ask_message:et[this.state.askForHelpIndex].message||"Hi, I am stuck. Please help.",allowInput:!0,buttonText:"Resolve",buttonLoadingText:"Loading...",placeholder:"Write a solution for this blocker.",successMessage:"Blockers resolved!",characterLimit:1e3,showArrows:!0,user_name:et[this.state.askForHelpIndex].user_name,user_profile:et[this.state.askForHelpIndex].user_profile,created:et[this.state.askForHelpIndex].created,url:"/api/askforhelpV2/".concat(rt[this.state.askForHelpIndex].id,"/mentee/").concat($e||Z).concat(this.state.updateBlocker?"?update=true":""),type:"PUT",updateBlocker:this.state.updateBlocker,setUpdateBlocker:function(e){return g.setUpdateBlocker(e)},feedbackRequired:!0,showAskForHelpRaise:this.state.showAskForHelpRaise,setShowAskForHelpRaise:function(e){return g.setShowAskForHelpRaise(e)},setShowAllAskForHelps:function(e){return g.setShowAllAskForHelps(e)},currentBlocker:this.state.askForHelpIndex,totalBlockers:et.length,canUpdateBlockers:Xe,setAskForHelpIndex:function(e){e>0?g.setAskForHelpIndex(g.state.askForHelpIndex+1>=et.length?0:g.state.askForHelpIndex+1):g.setAskForHelpIndex(g.state.askForHelpIndex-1<0?et.length-1:g.state.askForHelpIndex-1)}}})})})})]});return!T.ask_for_signup||T.isAccessibleForFree||null!==Z&&void 0!==Z||(lt=(0,x.jsx)(xe.Z,{message:"A Free Signup is required to view this lesson.",illustration:(0,x.jsx)(ye,{}),actionButtons:(0,x.jsx)("button",{className:"contained-primary w-full m-0",onClick:function(){g.props.dispatch(Y.n.show(J.kp,{ru:"/collection/page/".concat(y,"/").concat(I,"/").concat(m)}))},children:"Sign Up"})})),(0,x.jsx)(ke.ZP,{children:(0,x.jsxs)(ke.WT,{contentWidth:z,children:[(0,x.jsxs)(K.default,{children:[ze&&(0,x.jsx)("link",{rel:"canonical",href:ze}),(0,x.jsx)("title",{children:Ne}),(0,x.jsx)("meta",{property:"og:title",content:Ne})]}),(0,x.jsx)(X.Z,{pageSummary:!E&&C?Te(Te({},F),{},{title:b}):F,coverImage:B,author:S,isCollectionArticle:C,pathAuthorId:Ie,pathId:we,askForHelp:this.state.askForHelps,isPlan:Ae,askForHelpCreate:this.askForHelpCreate,userId:Z,menteeId:$e,isMentee:Xe,loadAskForHelp:this.loadAskForHelps,showAllAskForHelps:this.state.showAllAskForHelps,setShowAllAskForHelps:this.setShowAllAskForHelps,showAskForHelpRaise:this.state.showAskForHelpRaise,setShowAskForHelpRaise:this.setShowAskForHelpRaise,activeBlockers:st,totalBlockers:it,askForHelpTaskId:this.state.askForHelpTaskId,showAskForHelpRaiseButton:((Qe||ot||nt)&&this.state.askForHelpTaskId||Xe)&&Ae&&Re(this.props),showAskForHelpViewButton:(Qe||ot||nt||Xe)&&Ae&&Re(this.props),viewBlockersBtn:this.viewBlockersBtn,children:!E&&Ue&&(0,x.jsx)(te.Z,{children:Ue})}),lt,!E&&(0,x.jsx)(ge,{authorId:y,collectionId:I,pageId:m}),le||He||E||!C?null:(0,x.jsx)(ee.Z,{userId:Z,authorId:y,pageId:m,collectionId:I,pathAuthorId:null===re||void 0===re||null===(v=re.instance)||void 0===v?void 0:v.details.path_author_id,pathId:null===re||void 0===re||null===(_=re.instance)||void 0===_?void 0:_.details.path_id,isDraft:!1,isVersionsPage:w,previousNextArticles:j,collapsed:R,course_url_slug:U,nextModuleDetails:be,planInfo:se,planPreviousNextContent:ie,isStandaloneModule:de,optional:_e}),!E&&(0,x.jsx)(oe.$,{children:w||le?null:(0,x.jsx)(G.Z,{authorId:We,collectionId:Ve,pageId:Ke,pathAuthorId:Ie,pathId:we,planInfo:se,isStandaloneModule:de})}),P]})})}}],[{key:"getDerivedStateFromProps",value:function(e){return{removedCustomStyledContent:(0,Ce.hC)(e.comps)}}}]),o}(j.PureComponent);(0,O.Z)(Be,"defaultProps",{userThemes:"",vimMode:!1,approvedForSale:!0,handleSaveWidgetUserData:function(){}});var Ne=o(56819),De=o(54492),Me=o(74013),qe=o(68367),ze=o(54207),Ue=o(26081),We=o(67492),Ve=o(1401),Ke=o(29682),Ge=o(94999),Ye=o(96520),Je=o(8024),Xe=o(69798),$e=o(79694),Qe=o(13523),et=o(60136),tt=o(57294);function ot(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=(0,C.Z)(e);if(t){var r=(0,C.Z)(this).constructor;o=Reflect.construct(n,arguments,r)}else o=n.apply(this,arguments);return(0,S.Z)(this,o)}}function nt(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function rt(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?nt(Object(o),!0).forEach((function(t){(0,O.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):nt(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function st(e){var t;return null===e||void 0===e||null===(t=e.userInfo)||void 0===t?void 0:t.user_id}function it(e){var t,o=e.fetchPageAction,n=e.userInfo,r=e.router,s=e.collection,i=e.planInfo,l=n.user_id,a=(0,tt.Cm)(r.asPath).endsWith("/versions"),d=r.query,c=d.author_id,u=d.page_id,p=d.collection_id,h=Boolean(e.userInfo.user_id),f=(0,Ke.Z)(null===r||void 0===r?void 0:r.asPath);o?a?(e.dispatch(U.t.load(rt(rt({},r.query),{},{isDraft:a,router:r}))),e.dispatch(o(c,p,u))):(h&&e.dispatch((0,Ue.mt)({user_id:l})),(h||!i.isPlanLesson&&!i.isPlanModule)&&e.dispatch(U.t.load(rt(rt({},r.query),{},{router:r,work_type:f,organization_id:(i.isPlanLesson||i.isPlanModule)&&(null===s||void 0===s||null===(t=s.instance)||void 0===t?void 0:t.details.organization_id)}))),e.dispatch(o(rt(rt({},r.query),{},{work_type:f})))):a?(e.dispatch(z.E.load(c,u,"/draft")),e.dispatch(D.w.load(u))):(h&&e.dispatch((0,Ue.mt)({user_id:l})),e.dispatch(z.E.load(c,u)),e.dispatch(M.D.load(c,u,r)))}var lt=function(e){(0,P.Z)(o,e);var t=ot(o);function o(){var e;(0,H.Z)(this,o);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r)),(0,O.Z)((0,F.Z)(e),"state",{pageTableOfContent:null,scrolledToLink:!1,menteeSnaps:null}),(0,O.Z)((0,F.Z)(e),"componentWillUnmount",(function(){e.onPageUnmount(),window.removeEventListener("keydown",e.keydownHandler,!0),window.removeEventListener("beforeunload",e.onPageUnmount),e.clearContent(e.props),e.props.dispatch(U.t.clear())})),(0,O.Z)((0,F.Z)(e),"onPageUnmount",(function(){var t,o,n,r,s,i,l,a,d=e.props,c=d.collection,u=d.dispatch,p=d.onPageUnmount,h=d.pageProps,f=d.router,v=d.userInfo,_=(0,tt.Cm)(f.asPath).endsWith("/versions"),g=h.author_id,k=h.collection_id,m=h.page_id,y=h.external_author_id,x=h.external_collection_id,I=h.external_page_id,w=!(null===c||void 0===c||null===(t=c.instance)||void 0===t||!t.details.path_id)&&!(null===c||void 0===c||null===(o=c.instance)||void 0===o||!o.details.path_author_id)&&(null===c||void 0===c||null===(n=c.instance)||void 0===n?void 0:n.details.work_type)===$.dL.COLLECTION;return p(v,I?y:g,I?x:k,m,_,u,void 0,void 0,w?null===c||void 0===c||null===(r=c.instance)||void 0===r?void 0:r.details.path_id:Number(null===c||void 0===c||null===(s=c.instance)||void 0===s?void 0:s.details.collection_id),w?null===c||void 0===c||null===(i=c.instance)||void 0===i?void 0:i.details.path_author_id:Number(null===c||void 0===c||null===(l=c.instance)||void 0===l?void 0:l.details.author_id),w?$.dL.MODULE:null===c||void 0===c||null===(a=c.instance)||void 0===a?void 0:a.details.work_type)})),(0,O.Z)((0,F.Z)(e),"keydownHandler",(function(t){var o=e.props.router,n=(0,tt.Cm)(o.asPath).endsWith("/versions"),r=t.metaKey,s=t.ctrlKey,i="s"===t.key;if((r||s)&&i)t.preventDefault();else if(n){var l="e"===t.key;(r||s)&&l&&!t.shiftKey&&(t.preventDefault(),e.goToEdit())}})),(0,O.Z)((0,F.Z)(e),"handleDiscourseInteraction",(function(){(0,Se.qP)(Se.f2.INTERACTION,Se.bt.INTERACTION_DISCOURSE_LINK_CLICKED)})),(0,O.Z)((0,F.Z)(e),"isCollectionArticle",(function(){return null!=e.props.router.query.collection_id||null!=e.props.router.query.course_url_slug})),(0,O.Z)((0,F.Z)(e),"goToEdit",(function(){var t=e.props.router.query,o=t.author_id,n=t.page_id,r=t.collection_id,s=r?"/pageeditor/".concat(o,"/").concat(r,"/").concat(n):"/pageeditor/".concat(n);"/demo/draft"!==e.props.router.pathname?e.props.router.push(s):e.props.router.push("/demo")})),(0,O.Z)((0,F.Z)(e),"goToPlan",(function(){var t=e.props,o=t.planInfo,n=t.router,r=t.collection;if(o.isPlanLesson){var s=n.query,i=s.author_id,l=s.collection_id;e.props.router.push("/plan/".concat(i,"/").concat(l))}else{var a,d=null===r||void 0===r||null===(a=r.instance)||void 0===a?void 0:a.details,c=d.path_author_id,u=d.path_id;e.props.router.push("/plan/".concat(c,"/").concat(u))}})),(0,O.Z)((0,F.Z)(e),"restoreSelectedSnapshot",(function(){var t=e.props,o=t.authorId,n=t.collectionId,r=t.firstSnapshot,s=t.selectedSnapshot,i=t.router,l=e.props.router.query.page_id||e.props.pageProps.page_id;r.key!==s.key&&e.props.dispatch((0,ze.Z)(i,o,n,null,l,s.key,$.qe.COLLECTION_LESSON))})),(0,O.Z)((0,F.Z)(e),"onClickReaderPreferencesButton",(function(){(0,e.props.dispatch)(Y.n.show(J.VF)),(0,Se.qP)(Se.f2.COURSE,Se.bt.INTERACTION_READER_PREFERENCES,"OPEN")})),(0,O.Z)((0,F.Z)(e),"clearContent",(function(e){var t=e.clearPageAction;t?e.dispatch(t()):e.dispatch(M.D.clear())})),e}return(0,b.Z)(o,[{key:"componentDidMount",value:function(){window.addEventListener("keydown",this.keydownHandler,!0),it(this.props),this.isCollectionArticle()||this.props.dispatch(q.n.load(this.props.router.query.author_id)),window.addEventListener("beforeunload",this.onPageUnmount),this.isCollectionArticle()&&!(0,tt.Cm)(this.props.router.asPath).endsWith("/versions")&&st(this.props)&&this.props.onPageMount()}},{key:"shouldComponentUpdate",value:function(e){return e.router.query.page_id===this.props.router.query.page_id&&e.router.query.page_url_slug===this.props.router.query.page_url_slug||(this.onPageUnmount(),this.clearContent(this.props),this.props.dispatch(U.t.clear())),!0}},{key:"componentDidUpdate",value:function(){var e=(0,A.Z)(w().mark((function e(t){var o,n,r,s,i,l,a,d,c,u,p,h,f,v,_,g,k,m,y,x,I,A,H,b,F,P,S,C,O,j,E,Z,T,L,R,B,N,D,M,q,z;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.pageProps.page_table_of_content===this.props.pageProps.page_table_of_content&&this.props.comps===t.comps){e.next=18;break}if(a=this.props.comps,d=this.props.pageProps.page_table_of_content,!("/demo/draft"===this.props.router.pathname&&this.props.pageSummary.pageTocEnabled||null!==(l=this.props.pageProps)&&void 0!==l&&l.page_table_of_content)){e.next=17;break}return e.prev=4,e.next=7,(0,Me.TE)(a);case 7:c=e.sent,u=c.TOC,p=c.updatedComps,d=u,a=p,e.next=17;break;case 14:e.prev=14,e.t0=e.catch(4),(0,et.u)(e.t0);case 17:this.setState({comps:a,pageTableOfContent:d});case 18:t.router.query.page_id===this.props.router.query.page_id&&t.router.query.page_url_slug===this.props.router.query.page_url_slug||(it(this.props),this.isCollectionArticle()&&!(0,tt.Cm)(this.props.router.asPath).endsWith("/versions")&&st(this.props)&&this.props.onPageMount()),h=this.props.planInfo,st(this.props)!==st(t)&&(null!==h&&void 0!==h&&h.isPlanLesson||null!==h&&void 0!==h&&h.isPlanModule)&&(_=this.props.router,this.props.dispatch(U.t.load(rt(rt({},_.query),{},{router:_,work_type:(0,Ke.Z)(null===_||void 0===_?void 0:_.asPath),organization_id:(h.isPlanLesson||h.isPlanModule)&&(null===(f=this.props.collection)||void 0===f||null===(v=f.instance)||void 0===v?void 0:v.details.organization_id)})))),g=this.props.pageProps,k=g.page_id,m=g.author_id,y=g.collection_id,x=g.external_author_id,I=g.external_collection_id,A=this.props,H=A.isCollectionOwnedByReader,b=A.isCollectionOwnedByAuthor,F=A.isCollectionPriced,P=A.percentCompleted,S=A.dispatch,C=A.previousNextArticles,O=(H||!F)&&!b&&P<100,null!==(o=t.pageProps)&&void 0!==o&&o.docker||null===(n=this.props.pageProps)||void 0===n||!n.docker||(E={docker:null===(j=this.props.pageProps)||void 0===j?void 0:j.docker,author_id:x||m,collection_id:I||y},S((0,de.fo)(E))),(null===(r=t.pageProps)||void 0===r||!r.external_api_keys)&&null!==(s=this.props.pageProps)&&void 0!==s&&s.external_api_keys&&this.props.pageProps.external_api_keys.length>0&&(T=null===(Z=this.props.pageProps)||void 0===Z?void 0:Z.external_api_keys,S(ce.X5.addExternalApiKeys(T))),st(this.props)&&k&&null!==C&&void 0!==C&&C.completionLoaded&&(k!==t.pageProps.page_id||!(null===C||void 0===C||!C.completionLoaded)!==!(null===(i=t.previousNextArticles)||void 0===i||!i.completionLoaded))&&S((0,qe.ny)({collection_id:y,author_id:m,payload:{LAST_VISITED:k,resumable:O}}));try{null!==(L=window.location)&&void 0!==L&&L.hash&&!this.state.scrolledToLink&&(B=document.querySelector(null===(R=window.location)||void 0===R?void 0:R.hash))&&(B.scrollIntoView(),(N=window.scrollY)&&window.scroll(0,N-Ve.WG),this.setState({scrolledToLink:!0}))}catch(w){console.log("could not scroll link into view: ",null===(D=window.location)||void 0===D?void 0:D.hash)}if(!this.props.userCollectionArticle.loaded||this.props.userCollectionArticle.loading){e.next=45;break}if(null===(M=this.props.router)||void 0===M||null===(q=M.query)||void 0===q||!q.scrollParams){e.next=45;break}z=0;case 32:if(!(z<5)){e.next=45;break}return e.prev=33,e.next=36,(0,Ye._v)(2e3);case 36:return this.props.navigateToHighlight(!0),e.abrupt("break",45);case 40:e.prev=40,e.t1=e.catch(33);case 42:z++,e.next=32;break;case 45:case"end":return e.stop()}}),e,this,[[4,14],[33,40]])})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e,t,o,n=this,r=this.props,s=r.cover_image_id,i=r.router,l=r.contentLoading,a=r.authorName,d=r.pageProps,c=r.profile_image_serving_url,u=r.collectionSideBarVisible,p=r.percentCompleted,h=r.userInfo,f=r.comps,v=r.dispatch,_=r.planInfo,g=this.state.pageTableOfContent,k=this.props.router.query.author_id||this.props.pageProps.author_id||this.props.authorId,m=this.props.router.query.collection_id||this.props.pageProps.collection_id||this.props.collectionId,y=this.props.router.query.page_id||this.props.pageProps.page_id;if(!y&&"/demo/draft"!==this.props.router.pathname)return null;var I=(null===h||void 0===h?void 0:h.user_id)||null,w=null;if(I&&(k&&m)&&this.props.defaultCourseLanguage){var A="defaultLanguage_".concat(k,"_").concat(m);w=this.props.defaultCourseLanguage[A]}var H=this.props.router.query.course_url_slug,b=(0,tt.Cm)(i.asPath).endsWith("/versions"),F=(0,De.Z)(this.isCollectionArticle(),b,k,y,s,m),P={author_id:k,author_name:a,profile_image_serving_url:c},S=null===(e=this.props.readerPreferences)||void 0===e?void 0:e.themes,C=null===(t=this.props.readerPreferences)||void 0===t?void 0:t.vimMode,O=(null===(o=this.props.readerPreferences)||void 0===o?void 0:o.contentWidth)||"default";return(0,x.jsxs)(x.Fragment,{children:[this.getCustomButtons().length>0&&(0,x.jsx)(Ne.default,{buttons:this.getCustomButtons()}),(0,x.jsx)(ke.ZP,{blockDisplay:!0,id:"handleArticleScroll",children:(0,x.jsxs)(N.Z,{collectionSideBarVisible:this.isCollectionArticle()&&u,versionsHistoryVisible:b,children:[(0,x.jsx)(B.Z,{loading:l}),(0,x.jsx)("div",{style:{minHeight:"calc(100vh - 170px)"},children:(0,x.jsx)(Be,rt(rt({},this.props),{},{comps:this.state.comps||this.props.comps,userId:I,pageId:y,authorId:k,collectionId:m,percentCompleted:p,isVersionsPage:b,author:P,isCollectionArticle:this.isCollectionArticle(),pageProps:rt(rt({},d),{},{page_table_of_content:g}),coverImage:s&&F,userThemes:S,vimMode:C,contentWidth:O,course_url_slug:H,componentVisibilityChange:this.props.componentVisibilityChange,defaultCourseLanguage:w,handleSaveWidgetUserData:function(e,t){var o=t.compId,r=t.reset;return i.query.collection_id?n.props.handleSaveWidgetUserData(e,{compId:o,reset:r}):(0,Ge.u)(e,o,r,null===h||void 0===h?void 0:h.user_id,i,d,{},f,v)},planInfo:_}))})]})})]})}},{key:"getCustomButtons",value:function(){var e,t,o,n,r,s=this.props,i=s.firstSnapshot,l=s.selectedSnapshot,a=s.onNotesClick,d=s.router,c=s.showVersionHistory,u=s.planInfo,p=s.collection,h=s.pageProps,f=i.key===l.key,v=(0,tt.Cm)(d.asPath).endsWith("/versions"),_=null===p||void 0===p||null===(e=p.instance)||void 0===e||null===(t=e.details)||void 0===t?void 0:t.title,g=null===p||void 0===p||null===(o=p.instance)||void 0===o||null===(n=o.details)||void 0===n?void 0:n.path_title,k=(null===(r=this.props.previousNextArticles)||void 0===r?void 0:r.is_current_page_lesson)&&h.discourse_page_url,m=u.isPlanLesson||u.isPlanModule;return[v&&!this.props.isInReviewerMode&&c&&{type:"primary",text:"Restore",method:this.restoreSelectedSnapshot,icon:(0,x.jsx)(T.Z,{size:20}),key:"Restore Button",disable:f,disableMessage:"You're already on latest version","aria-label":"restore-button"},!v&&!m&&st(this.props)&&k&&{type:"transparent",text:(0,x.jsx)("a",{id:"discourseLink",href:h.discourse_page_url,target:"_blank",rel:"noopener noreferrer",onClick:this.handleDiscourseInteraction,children:(0,x.jsx)("div",{id:"feedback_menu",role:"none",children:(0,x.jsxs)("div",{className:"flex items-center",children:[(0,x.jsx)(Qe.Z,{className:"w-6 h-6 fill-current"}),(0,x.jsx)("span",{className:"font-normal ml-2",children:"Ask a Question"})]})})}),key:"Ask a Question Button"},!v&&m&&st(this.props)&&$.Fz&&{type:"text-default",text:u.isPlanLesson?_:g,method:this.goToPlan,key:"View Plan Button",tooltip:!0,tooltipMessage:"Go Back to Plan",icon:(0,x.jsx)(Xe.Z,{className:"w-5 h-5 flex-shrink-0"})},!v&&st(this.props)&&{type:m?"text-default":"primary",text:"Options",alwaysShowIcon:!0,method:this.onClickReaderPreferencesButton,icon:m?(0,x.jsx)($e.Z,{size:20}):(0,x.jsx)(L.Z,{size:20}),key:"Options Button",page:void 0!==this.props.collectionId?"collection":"tutorial",id:"ReaderPreferencesButton","aria-label":"options-button"},!m&&!v&&st(this.props)&&void 0!==this.props.collectionId&&{type:"primary",text:"Notes",alwaysShowIcon:!0,method:a,icon:(0,x.jsx)(R.Z,{size:20,id:$.Fz?"selenium-open-highlights-form":null}),key:"Notes Button",tooltip:!0,tooltipMessage:"Saved notes and highlights"}].filter(Boolean)}}]),o}(j.Component);(0,O.Z)(lt,"defaultProps",{showVersionHistory:!1,isInReviewerMode:!1,onPageMount:function(){},onPageUnmount:function(){},onNotesClick:function(){},navigateToHighlight:function(){},handleSaveWidgetUserData:function(){},planInfo:{}});var at=(0,E.$j)((function(e,t){var o,n,r,s,i=e.author,l=i.page,a=i.collectionArticle,d=i.profile,c=i.articleRevisions,u=i.collection,p=void 0===u?{}:u,h=e.user,f=e.page,v=e.userCollectionArticle,_=e.widgets,g=e.pageSummary,k=e.pagePreview,m=e.collectionArticlePreview,y=e.userConfig,x=e.dockerDetails,I=t.router,w=I.query,A=I.asPath;s=(0,tt.Cm)(A).endsWith("/versions")?w.collection_id?a:l:w.collection_id||w.course_url_slug?v:f;var H=w.collection_id||w.course_url_slug?m:k,b=c.data,F=(0,We.H)(b).firstSnapshot,P=function(e){var t,o,n=null!==(t=null===e||void 0===e?void 0:e.collectionId)&&void 0!==t?t:void 0;n&&(n=Number(n));var r=null!==(o=null===e||void 0===e?void 0:e.authorId)&&void 0!==o?o:void 0;r&&(r=Number(r));return{collectionId:n,authorId:r}}(p),S=P.collectionId,C=P.authorId,O=_.ids.map((function(e){return _.entities[e]})),j=function(e){var t,o,n,r;return null!==(t=null===e||void 0===e||null===(o=e.instance)||void 0===o||null===(n=o.details)||void 0===n||null===(r=n.toc)||void 0===r?void 0:r.categories)&&void 0!==t?t:[]}(p),E=null!==(o=null===p||void 0===p||null===(n=p.instance)||void 0===n?void 0:n.details)&&void 0!==o?o:{},Z=E.url_slug,T=E.path_id,L=E.path_author_id;return rt(rt({firstSnapshot:F||{},selectedSnapshot:(null===(r=c.data)||void 0===r?void 0:r.selectedSnapshot)||{},collectionId:S,authorId:C},w.collection_id?{}:{comps:O}),{},{categories:j,docker:ct(x),pageSummary:g,pageSize:_.ids.length+1,contentLoading:s.loading,contentLoaded:s.loaded,cover_image_id:!1===s.loading&&!0===s.loaded?s.data.cover_image_id:null,pageProps:!1===H.loading&&!0===H.loaded?H.data:{},readerPreferences:h.readerPreferences,defaultCourseLanguage:h.defaultCourseLanguage,authorName:w.collection_id||!1!==d.loading||!0!==d.loaded?null:d.data.full_name,profile_image_serving_url:!w.collection_id&&d.loaded?d.data.profile_image_serving_url:null,widgetSnapshots:(0,W.XU)(h),executionMetadata:y,userCollectionArticle:v,url_slug:Z,path_id:T,path_author_id:L,userInfo:h.info.data||{}})})),dt=(at(lt),(0,Z.withRouter)((0,Je.Z)(at(lt)))),ct=function(e){return null!==e&&void 0!==e?e:{}}},94999:function(e,t,o){o.d(t,{G:function(){return _},u:function(){return g}});var n=o(93586),r=o(63319),s=o(84184),i=o(1401),l=o(49227),a=o(12006),d=o(16962),c=o(37636),u=o(29682),p=o(74156),h=o(44124);function f(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function v(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?f(Object(o),!0).forEach((function(t){(0,n.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):f(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var _=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(null!==e&&void 0!==e&&e.scrollParams){var o=JSON.parse(null===e||void 0===e?void 0:e.scrollParams),n=o.scroll,r=o.scrollId;if((0,p.gx)(n)){var s,l=document.querySelectorAll("[data-id='".concat(r,"']"));if(!l.length){if(t)throw Error(h.pX.missingHighlight);return}Array.from(l).forEach((function(e){e.style.backgroundColor="#FF715B",e.style.transition="3s",setTimeout((function(){return e.style.backgroundColor="#e5dfff"}),2e3)}));var a=5,d=window.pageYOffset+(null===(s=l[0])||void 0===s?void 0:s.getBoundingClientRect().top);if(!d)return;var c=d-i.WG-a;window.scroll({top:c,behavior:"smooth"})}}},g=function(e,t,o,n,i,p,h,f,_){var g,k,m=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,y=i.query.page_id||p.page_id,x=i.query.collection_id||p.collection_id||h.collectionId,I=i.query.author_id||p.author_id||h.authorId,w=null===h||void 0===h||null===(g=h.instance)||void 0===g?void 0:g.details.path_author_id,A=null===h||void 0===h||null===(k=h.instance)||void 0===k?void 0:k.details.path_id;if(n){var H=v({compId:t,userId:n},(null===p||void 0===p?void 0:p.item_type)===l.RI.LESSON?{pageId:p.external_page_id,collectionId:p.external_collection_id,authorId:p.external_author_id}:(null===p||void 0===p?void 0:p.item_type)===l.RI.SHOT?{shotId:p.shot_id}:{pageId:y,collectionId:x,authorId:I});_((0,r.ls)(e,H,{reset:o},(null===p||void 0===p?void 0:p.item_type)===l.RI.SHOT?l.RI.SHOT:null)),(m||f).forEach((function(e){var n;if((null===e||void 0===e||null===(n=e.content)||void 0===n?void 0:n.comp_id)===t){var r=o?c.bt.INTERACTION_RESET_WIDGET_USERDATA:c.bt.INTERACTION_SAVE_WIDGET_USERDATA;(0,c.qP)(c.f2.INTERACTION,r,e.type)}}))}else if((null===p||void 0===p?void 0:p.item_type)!==l.RI.SHOT){var b=x?(0,s.Z)(I,x,null,y,null,!1,null,null,(0,u.Z)(i.asPath),w,A).viewUrl.href:"/page/".concat(I,"/").concat(y);(0,c.qP)(c.f2.SIGNUP,c.bt.SIGNUP_INIT_SAVE_WIDGET_USERDATA,b),_(d.n.show(a.ym,{ru:b,title:"Login to save progress"}))}}},13523:function(e,t,o){var n,r=o(89703);function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e}).apply(this,arguments)}t.Z=function(e){return r.createElement("svg",s({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"text-black dark:text-dark-contrastText fill-current"},e),n||(n=r.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5 1.5h14a2 2 0 012 2v14a2 2 0 01-2 2h-4l-3 3-3-3H5a2 2 0 01-2-2v-14c0-1.1.9-2 2-2zm9.2 16H19v-14H5v14h4.8l.6.6 1.6 1.6 1.6-1.6.6-.6zm-3.2-1v-2h2v2h-2zm3-8a2 2 0 00-2-2 2 2 0 00-2 2H8a4 4 0 118 0c0 1.3-.8 2-1.6 2.6-.7.7-1.4 1.3-1.4 2.4h-2c0-1.8 1-2.5 1.8-3.2.6-.5 1.2-1 1.2-1.8z",fill:"current"})))}}}]);
//# sourceMappingURL=25862-1dc9e1b0062bc283dcb7.js.map