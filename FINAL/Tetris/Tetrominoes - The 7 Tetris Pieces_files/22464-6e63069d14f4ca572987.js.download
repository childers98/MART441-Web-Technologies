"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[22464],{22464:function(e,i,l){var o=l(20348),n=l(32868),t=l(79003),d=l(70989),a=l(58055),u=l(31428),c=l(27018),r=l(29799),s=l(93586),v=l(89703),p=l(78854),_=l(17279),f=l(80414),h=l(83200),g=l(80944),m=l(49227),y=l(29682),O=l(75843),C=l(17412),S=l(50844),P=l(57294);function w(e,i){var l=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);i&&(o=o.filter((function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable}))),l.push.apply(l,o)}return l}function b(e){for(var i=1;i<arguments.length;i++){var l=null!=arguments[i]?arguments[i]:{};i%2?w(Object(l),!0).forEach((function(i){(0,s.Z)(e,i,l[i])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(l)):w(Object(l)).forEach((function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(l,i))}))}return e}function k(e){var i=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var l,o=(0,r.Z)(e);if(i){var n=(0,r.Z)(this).constructor;l=Reflect.construct(o,arguments,n)}else l=o.apply(this,arguments);return(0,c.Z)(this,l)}}var L=function(e){var i=e.split("/");return i[1]===m.dL.MODULE&&"preview"===i[i.length-1]};var j=(0,p.$j)((function(e){var i=e.author,l=i.collection,o=i.profile,n=e.loader,t=e.search,d=e.dockerDetails;return{userInfo:e.user.info.data,collection:l,dockerDetails:d,profile:o,searchString:t.searchString,contentLoaded:n.isLoaded,contentLoading:n.isLoading}}),(function(e){return{dispatch:e,showEducativeBanner:function(i,l){return e(O.R.show(i,l))},hideEducativeBanner:function(i){return e(O.R.hide(i))}}}));i.Z=function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return function(e){var l=function(l){(0,u.Z)(r,l);var c=k(r);function r(){var e;(0,t.Z)(this,r);for(var l=arguments.length,o=new Array(l),d=0;d<l;d++)o[d]=arguments[d];return e=c.call.apply(c,[this].concat(o)),(0,s.Z)((0,a.Z)(e),"state",{cover_image:e.props.ssrContent?e.prepareCollectionCover(e.props.ssrContent):{},assessmentPagesMap:null,is_draft_page:"undefined"!==typeof i?i:!!e.props.router.pathname.match(/draft/gi),isModuleOrPathPage:[m.dL.MODULE,m.dL.PATH].includes((0,y.Z)(e.props.router.asPath))}),(0,s.Z)((0,a.Z)(e),"componentDidUpdate",(function(i){var l,o,n,t,d,a=e.props,u=a.dispatch,c=a.collection,r=a.router.query,s=r.collection_id,v=r.course_url_slug;s===i.router.query.collection_id&&v===i.router.query.course_url_slug||u((0,_.l3)()),e.loadCollection(),Object.keys(e.state.cover_image).length||(Object.keys(c).length||!Object.keys(i.collection).length)&&(null===(l=i.collection)||void 0===l||null===(o=l.instance)||void 0===o||null===(n=o.details)||void 0===n?void 0:n.cover_image_id)===(null===c||void 0===c||null===(t=c.instance)||void 0===t||null===(d=t.details)||void 0===d?void 0:d.cover_image_id)||e.setState({cover_image:e.prepareCollectionCover(c)})})),(0,s.Z)((0,a.Z)(e),"loadCollection",(function(){var i=e.state,l=i.is_draft_page,o=i.isModuleOrPathPage,t=e.props,d=t.collection,a=t.contentLoading,u=t.contentLoaded,c=t.router,r=c.query,s=r.author_id,v=r.collection_id,p=r.course_url_slug,f=r.path_author_id,h=r.path_id,m=c.asPath,y=0===Object.keys(d).length,O=1===Object.keys(d).length&&d.instance;a||u||!y&&!O||!(s||v||p)||e.props.dispatch((0,_._N)({params:{author_id:s,collection_id:v,course_url_slug:p,path_author_id:f,path_id:h,is_draft_page:l},router:c,ignoreLoadingState:o,isModulePreview:L((0,P.Cm)(m))})).then((function(){var i,l,o,t,d=null===(i=e.props.collection)||void 0===i||null===(l=i.instance)||void 0===l||null===(o=l.details)||void 0===o||null===(t=o.pages_with_dangling_concepts)||void 0===t?void 0:t.map((function(e){return e.page_id}));if(null!==d&&void 0!==d&&d.length){var a,u,c,r,s,v,p,_,f,h,m,y,O,C,S=null===(a=e.props.collection)||void 0===a||null===(u=a.instance)||void 0===u||null===(c=u.details)||void 0===c||null===(r=c.toc)||void 0===r?void 0:r.categories.filter((function(e){return"COLLECTION_ASSESSMENT"===e.type})).map((function(e){return e.id})),P=null===(s=e.props.collection)||void 0===s||null===(v=s.instance)||void 0===v||null===(p=v.details)||void 0===p||null===(_=p.toc)||void 0===_?void 0:_.categories.filter((function(e){return"COLLECTION_CATEGORY"===e.type})).flatMap((function(e){return e.pages.map((function(e){return e.page_id}))})),w=new Set(S),b=new Set(P);(0,n.Z)(d).filter((function(e){return!w.has(e)&&!b.has(e)})).length&&(0,g.NT)(null===(f=e.props.collection)||void 0===f||null===(h=f.instance)||void 0===h||null===(m=h.details)||void 0===m?void 0:m.author_id,null===(y=e.props.collection)||void 0===y||null===(O=y.instance)||void 0===O||null===(C=O.details)||void 0===C?void 0:C.collection_id,{assessment_ids:JSON.stringify(S)}).then((function(i){e.setState({assessmentPagesMap:JSON.parse(i)})})).catch((function(e){}))}}))})),e}return(0,d.Z)(r,[{key:"componentDidMount",value:function(){this.loadCollection()}},{key:"componentWillUnmount",value:function(){var e,i,l=this.props,o=l.collection,n=l.dispatch,t=(null===o||void 0===o||null===(e=o.instance)||void 0===e?void 0:e.details.work_type)===m.dL.PATH,d=null===o||void 0===o||null===(i=o.instance)||void 0===i?void 0:i.details.is_plan;n((0,_.l3)()),!d&&t&&(n(C.W.clear()),n(S.J.clear()))}},{key:"prepareCollectionCover",value:function(e){var i,l,o,n,t,d,a,u,c,r,s,v=null===e||void 0===e||null===(i=e.instance)||void 0===i||null===(l=i.details)||void 0===l?void 0:l.author_id,p=null===e||void 0===e||null===(o=e.instance)||void 0===o||null===(n=o.details)||void 0===n?void 0:n.collection_id,_=null===e||void 0===e||null===(t=e.instance)||void 0===t||null===(d=t.details)||void 0===d?void 0:d.cover_image_id;return _?{updated:!1,image_id:_,image:null!==(a=this.state)&&void 0!==a&&a.is_draft_page?"/api/author/".concat(v,"/collection/").concat(p,"/image/").concat(_):"/api/collection/".concat(v,"/").concat(p,"/image/").concat(_),metadata:null!==e&&void 0!==e&&null!==(u=e.instance)&&void 0!==u&&null!==(c=u.details)&&void 0!==c&&c.cover_image_metadata?JSON.parse(null===e||void 0===e||null===(r=e.instance)||void 0===r||null===(s=r.details)||void 0===s?void 0:s.cover_image_metadata):void 0}:{}}},{key:"render",value:function(){var i,l,n,t,d,a,u,c,r,s,v,p,_,h,g,m,y,O,C,S,w,k,j,E,Z,T,M,D,x,R,N,B,A,J,I,U,q,F,z,H,W,G,Y,$,K,Q,V,X,ee,ie,le,oe,ne,te,de,ae,ue,ce,re,se,ve,pe,_e,fe,he,ge,me,ye,Oe,Ce,Se,Pe,we,be=this.props,ke=be.collection,Le=be.dispatch,je=be.userInfo,Ee=be.searchString,Ze=be.contentLoaded,Te=be.contentLoading,Me=be.profile,De=be.match,xe=be.dockerDetails,Re=be.certificatePrice,Ne=be.ssrContent,Be=be.showEducativeBanner,Ae=be.hideEducativeBanner,Je=be.router,Ie=null!==(i=null===ke||void 0===ke||null===(l=ke.instance)||void 0===l||null===(n=l.details)||void 0===n?void 0:n.author_id)&&void 0!==i?i:null===Ne||void 0===Ne||null===(t=Ne.instance)||void 0===t||null===(d=t.details)||void 0===d?void 0:d.author_id,Ue=null!==(a=null===ke||void 0===ke||null===(u=ke.instance)||void 0===u||null===(c=u.details)||void 0===c?void 0:c.collection_id)&&void 0!==a?a:null===Ne||void 0===Ne||null===(r=Ne.instance)||void 0===r||null===(s=r.details)||void 0===s?void 0:s.collection_id,qe="review"===(null===ke||void 0===ke||null===(v=ke.instance)||void 0===v||null===(p=v.details)||void 0===p?void 0:p.collaboration_mode),Fe=this.state,ze=Fe.cover_image,He=Fe.is_draft_page,We=Fe.assessmentPagesMap,Ge=ke&&(null===ke||void 0===ke||null===(_=ke.instance)||void 0===_||null===(h=_.details)||void 0===h?void 0:h.CodeThemes)?{Code:null===ke||void 0===ke||null===(g=ke.instance)||void 0===g||null===(m=g.details)||void 0===m||null===(y=m.CodeThemes)||void 0===y?void 0:y.Code,Markdown:null===ke||void 0===ke||null===(O=ke.instance)||void 0===O||null===(C=O.details)||void 0===C||null===(S=C.CodeThemes)||void 0===S?void 0:S.Markdown,RunJS:null===ke||void 0===ke||null===(w=ke.instance)||void 0===w||null===(k=w.details)||void 0===k||null===(j=k.CodeThemes)||void 0===j?void 0:j.RunJS,SPA:null===ke||void 0===ke||null===(E=ke.instance)||void 0===E||null===(Z=E.details)||void 0===Z||null===(T=Z.CodeThemes)||void 0===T?void 0:T.SPA,isForced:null!==(M=null===ke||void 0===ke||null===(D=ke.instance)||void 0===D||null===(x=D.details)||void 0===x||null===(R=x.CodeThemes)||void 0===R?void 0:R.isForced)&&void 0!==M?M:f.Z}:{},Ye=ke&&(null===ke||void 0===ke||null===(N=ke.instance)||void 0===N||null===(B=N.details)||void 0===B?void 0:B.code_exec_resource_metadata)?{file_id:null===ke||void 0===ke||null===(A=ke.instance)||void 0===A||null===(J=A.details)||void 0===J||null===(I=J.code_exec_resource_metadata)||void 0===I?void 0:I.file_id,file_name:null===ke||void 0===ke||null===(U=ke.instance)||void 0===U||null===(q=U.details)||void 0===q||null===(F=q.code_exec_resource_metadata)||void 0===F?void 0:F.file_name,file_size:null===ke||void 0===ke||null===(z=ke.instance)||void 0===z||null===(H=z.details)||void 0===H||null===(W=H.code_exec_resource_metadata)||void 0===W?void 0:W.file_size,file:null===ke||void 0===ke||null===(G=ke.instance)||void 0===G||null===(Y=G.details)||void 0===Y||null===($=Y.code_exec_resource_metadata)||void 0===$?void 0:$.file,updated:null===ke||void 0===ke||null===(K=ke.instance)||void 0===K||null===(Q=K.details)||void 0===Q||null===(V=Q.code_exec_resource_metadata)||void 0===V?void 0:V.updated,upload_url:null===ke||void 0===ke||null===(X=ke.instance)||void 0===X||null===(ee=X.details)||void 0===ee||null===(ie=ee.code_exec_resource_metadata)||void 0===ie?void 0:ie.upload_url,upload_success_url:null===ke||void 0===ke||null===(le=ke.instance)||void 0===le||null===(oe=le.details)||void 0===oe||null===(ne=oe.code_exec_resource_metadata)||void 0===ne?void 0:ne.upload_success_url,gcs_object_name:null===ke||void 0===ke||null===(te=ke.instance)||void 0===te||null===(de=te.details)||void 0===de||null===(ae=de.code_exec_resource_metadata)||void 0===ae?void 0:ae.gcs_object_name,uploadStatus:null===ke||void 0===ke||null===(ue=ke.instance)||void 0===ue||null===(ce=ue.details)||void 0===ce||null===(re=ce.code_exec_resource_metadata)||void 0===re?void 0:re.uploadStatus}:{},$e=(null===ke||void 0===ke||null===(se=ke.instance)||void 0===se||null===(ve=se.details)||void 0===ve?void 0:ve.pricing_locked)||!1,Ke=null===ke||void 0===ke||null===(pe=ke.instance)||void 0===pe||null===(_e=pe.details)||void 0===_e?void 0:_e.approval_status,Qe=null===ke||void 0===ke||null===(fe=ke.instance)||void 0===fe||null===(he=fe.details)||void 0===he?void 0:he.work_type,Ve=(null!==(ge=null===ke||void 0===ke||null===(me=ke.instance)||void 0===me||null===(ye=me.details)||void 0===ye?void 0:ye.read_time)&&void 0!==ge?ge:null===Ne||void 0===Ne||null===(Oe=Ne.instance)||void 0===Oe||null===(Ce=Oe.details)||void 0===Ce?void 0:Ce.read_time)||0,Xe={collection:ke,author_id:Ie,collection_id:Ue,courseUrlSlug:null!==(Se=null===ke||void 0===ke||null===(Pe=ke.instance)||void 0===Pe?void 0:Pe.details.url_slug)&&void 0!==Se?Se:null===Ne||void 0===Ne||null===(we=Ne.instance)||void 0===we?void 0:we.details.url_slug,dispatch:Le,userInfo:je,searchString:Ee,cover_image:ze,codeExecResourceFile:Ye,contentLoaded:Ze,contentLoading:Te,CodeThemes:Ge,profile:Me,match:De,dockerDetails:xe,disableEdit:qe,pricingLocked:$e,approvalStatus:Ke,collectionType:Qe,courseReadTime:Ve,assessmentPagesMap:We,certificatePrice:Re,showSideBar:this.props.showSideBar,ssrContent:Ne,isModulePreview:L((0,P.Cm)(Je.asPath)),showEducativeBanner:Be,hideEducativeBanner:Ae};return(0,o.jsx)(e,b({is_draft:He},Xe))}}]),r}(v.Component);return(0,s.Z)(l,"defaultProps",{params:{},showSideBar:!1}),(0,h.withRouter)(j(l))}}}}]);
//# sourceMappingURL=22464-6e63069d14f4ca572987.js.map