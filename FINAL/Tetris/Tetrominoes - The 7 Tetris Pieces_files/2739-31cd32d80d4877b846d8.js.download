"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2739],{2739:function(t,e,n){n.r(e),n.d(e,{TerminalWidget:function(){return dt},default:function(){return ut}});var r=n(20348),a=n(32868),i=n(88753),o=n.n(i),s=n(52198),c=n(79003),l=n(70989),d=n(58055),u=n(31428),p=n(27018),v=n(29799),m=n(93586),f=n(89703),h=n(72929),b=n(63048),g=n(20767),x=n(78854),y=n(72930),I=n(75880),w=n(33022),k=n(86229),T=n(72359),S=n(54046),C=w.ZP.div.withConfig({displayName:"styles__TerminalOptionsStyled",componentId:"xssay2-0"})(["display:flex;"," height:32px;align-items:center;",";"],{"--tw-bg-opacity":"1",backgroundColor:"rgba(210, 210, 214, var(--tw-bg-opacity))",".dark &":{"--tw-bg-opacity":"1",backgroundColor:"rgba(49, 49, 57, var(--tw-bg-opacity))"}},(function(t){var e=t.mode,n=t.collapsed;return"view"===e?n?(0,w.iv)(["cursor:s-resize;"]):(0,w.iv)(["cursor:n-resize;"]):(0,w.iv)(["margin-bottom:5px;padding:10px;line-height:normal;background-color:inherit;height:auto;"])})),Z=(0,w.ZP)(k.Z).withConfig({displayName:"styles__TerminalFormControl",componentId:"xssay2-1"})([""," border-radius:"," !important;width:100%;min-width:80%;"],{"--tw-text-opacity":"1",color:"rgba(0, 0, 0, var(--tw-text-opacity)) !important",".dark &":{"--tw-text-opacity":"1",color:"rgba(193, 193, 198, var(--tw-text-opacity)) !important"}},S.qH),j=w.ZP.div.withConfig({displayName:"styles__ButtonWrapper",componentId:"xssay2-2"})(["display:flex;align-items:center;"]),_=w.ZP.div.withConfig({displayName:"styles__TerminalActiveStatus",componentId:"xssay2-3"})(["margin:8px;width:8px;height:8px;background:",";border-radius:",";",";"],"#D42154",S.LI,(function(t){return t.terminalActiveStatus&&(0,w.iv)(["width:12px;height:12px;background:",";"],"#50CC2F")})),E=w.ZP.div.withConfig({displayName:"styles__Title",componentId:"xssay2-4"})(["display:inherit;align-items:center;width:100%;"]),O=w.ZP.div.withConfig({displayName:"styles__OptionsContainer",componentId:"xssay2-5"})(["display:flex;flex-direction:column;justify-content:flex-start;width:100%;"]),P=w.ZP.div.withConfig({displayName:"styles__OptionsScriptContainer",componentId:"xssay2-6"})(["display:flex;flex-direction:row;width:100%;",""],(function(t){return t.isKeys&&(0,w.iv)([""," border-radius:",";padding:8px;"],{"--tw-bg-opacity":"1",backgroundColor:"rgba(255, 255, 255, var(--tw-bg-opacity))",".dark &":{"--tw-bg-opacity":"1",backgroundColor:"rgba(21, 21, 30, var(--tw-bg-opacity))"}},S.QH)})),N=w.ZP.div.withConfig({displayName:"styles__OutputContainer",componentId:"xssay2-7"})(["max-height:0px;transition:max-height 0.4s ease-in;word-wrap:break-word;border-top:none !important;"," padding:10px 7px 0px 7px;.react-tabs [role='tab']:focus:after{background:transparent;}",""],{borderWidth:"1px",borderStyle:"solid","--tw-border-opacity":"1",borderColor:"rgba(210, 210, 214, var(--tw-border-opacity))",".dark &":{"--tw-border-opacity":"1",borderColor:"rgba(76, 76, 92, var(--tw-border-opacity))"}},(function(t){return t.outputVisible&&(0,w.iv)(["max-height:100vh;transition:max-height 0.4s ease-in;"])})),R=(0,w.ZP)(T.PG).withConfig({displayName:"styles__Tabs",componentId:"xssay2-8"})(["display:flex;flex-direction:column;align-self:stretch;",""],(function(t){return t.isProject&&(0,w.iv)(["overflow:hidden;height:100%;"])})),D=(0,w.ZP)(T.x5).withConfig({displayName:"styles__Tab",componentId:"xssay2-9"})(["",""],(function(t){return t.addTerminalBtn&&(0,w.iv)(["border-radius:"," !important;padding:0px 10px !important;"," min-width:10px;align-self:center;font-size:24px;"],S.we,{borderWidth:"1px",borderStyle:"solid","--tw-border-opacity":"1",borderColor:"rgba(229, 229, 229, var(--tw-border-opacity)) !important",".dark &":{"--tw-border-opacity":"1",borderColor:"rgba(40, 40, 48, var(--tw-border-opacity)) !important"}})})),A=(0,w.ZP)(T.Th).withConfig({displayName:"styles__TabList",componentId:"xssay2-10"})(["flex-wrap:wrap;"]),L=T.Op,V=C,W=n(92840),F=n(46662),U=n(37103),q=n(33212),H=n(51945),G=n(55024),z=n(36927),M=n.n(z),K=n(35589),B=n(82703),J=n(59087),$=n(57931),Q="flex justify-between p-2 border-solid border cursor-pointer dark:border-gray-A200",X=function(t){return(0,r.jsx)("div",{className:Q,onClick:t.onClick,children:(0,r.jsx)($.Z,{className:"w-5 h-5"})})},Y=function(t){var e=t.tabIds,n=t.activeTab,a=t.onTabClose,i=t.onTabAdd,o=t.onTabChange,s=(t.mode,t.onRelaunch),c=t.terminalLoading,l=t.terminalActiveStatus,d=t.collapsed;return(0,r.jsxs)("div",{className:"".concat(d?"tailwind-hidden":"flex"," items-center rounded-none border-full border-gray-300 dark:border-dark-70 flex-wrap"),children:[e.map((function(t,i){var s=n===t;return(0,r.jsxs)("div",{className:"flex justify-between self-stretch p-2 border cursor-pointer max-w-min ".concat(s?"text-white border-none bg-black dark:bg-dark-70":"text-current border-solid dark:border-gray-A200"),onClick:function(e){e.stopPropagation(),o(t)},children:[(0,r.jsx)("div",{className:"flex justify-start flex-grow items-center pr-3 truncate",children:"Terminal ".concat(i+1," ")},"".concat(t)),(0,r.jsx)("div",{className:"flex flex-col justify-center items-center",onClick:function(e){return function(t,e,n){t.stopPropagation(),a(e,n)}(e,t,i)},children:e.length>1&&(0,r.jsx)(J.Z,{className:"w-3 h-3"})})]},t)})),l&&(0,r.jsx)(X,{onClick:function(){i()}}),(0,r.jsx)("div",{className:Q,children:(0,r.jsx)(K.Z,{icon:"RefreshCw",onClick:s,size:12,margin:4,disabled:c||!l})})]})},tt=n(28100),et=n(96796),nt=function(t){var e,n=t.startScript,a=void 0===n?"":n,i=t.onScriptChange,o=t.onUpdateClicked,s=t.mode,c=t.terminalActiveStatus,l=t.terminalLoading,d=t.onCollapse,u=t.onRelaunch,p=t.collapsed,v=t.envs,m=t.widgetVersion,f=t.enableTesting,h=t.testingDocker,b=t.selectedDockerRunner,g=t.onDockerRunnerChanged,x=t.selectedEnvVars,y=void 0===x?{}:x,I=t.handleEnvVarSelection,w=void 0===I?function(){return null}:I,k=t.tabIds,T=t.activeTab,S=t.onTabAdd,C=t.onTabChange,N=t.onTabClose,R=M()((function(t){return i(t)}),125),D=(0,tt.m)("TerminalWidget",m,y,v);return(0,r.jsxs)("div",{className:"flex ".concat("edit"===s?"flex-col-reverse":"flex-col"),children:[(0,r.jsx)(Y,{tabIds:k,activeTab:T,onTabAdd:S,onTabChange:C,onTabClose:N,mode:s,onRelaunch:u,terminalLoading:l,terminalActiveStatus:c,collapsed:p}),(0,r.jsx)(V,{collapsed:p,mode:s,onClick:"view"===s?d:function(){},children:"edit"===s?(0,r.jsxs)(O,{children:[v.length>0&&(0,r.jsx)(B.Z,{title:"Environment Vars",envVars:v,selectedEnvVars:D,handleEnvVarSelection:w,isEnv:!0,children:(0,r.jsx)("div",{className:"mb-2",style:{width:"fit-content"},children:(0,r.jsx)(P,{isKeys:!0,children:"Select Env Vars"})})}),(0,r.jsxs)(P,{children:[(0,r.jsx)(Z,{placeholder:"Start Script (will only run for the first terminal)",componentClass:"textarea",defaultValue:a,onChange:function(t){var e=t.target.value;R(e)}},"terminal_form_control"),(0,r.jsx)(j,{children:(0,r.jsx)("button",{className:"contained-primary py-2 m-2",onClick:o,children:"Update"})},"terminal_update_wrapper")]}),f&&(0,r.jsx)(et.ZP,{className:"mx-2 my-2 w-20",docker:h,dockerType:q.a5.TESTING,selectedDockerRunner:b,onDockerRunnerChange:g,visibility:null===h||void 0===h||null===(e=h.container)||void 0===e?void 0:e.imageName})]}):[(0,r.jsx)(_,{terminalActiveStatus:c},"terminal_view_active_status"),(0,r.jsx)(E,{children:(0,r.jsx)("span",{className:"font-normal",children:"Terminal"})},"terminal_view_title"),(0,r.jsx)(j,{children:(0,r.jsx)(K.Z,{icon:"ChevronUp",rotate:p,size:24,margin:5})},"terminal_view_refresh_wrapper")]})]})},rt=n(80944),at=n(60003);function it(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function ot(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?it(Object(n),!0).forEach((function(e){(0,m.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):it(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function st(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,v.Z)(t);if(e){var a=(0,v.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,p.Z)(this,n)}}var ct=(0,y.default)((function(){return Promise.all([n.e(45135),n.e(22857),n.e(9040),n.e(89052)]).then(n.bind(n,89052))}),{loading:function(){return(0,r.jsx)("div",{children:"Loading..."})},ssr:!1,loadableGenerated:{webpack:function(){return[89052]},modules:["../components/widgets/TerminalWidget/index.tsx -> components/Terminal"]}});var lt=(0,x.$j)((function(t){return{activeTermID:t.terminalWidgetStats.activeTermID}}),(function(t){return{dispatch:t}})),dt=function(t){(0,u.Z)(n,t);var e=st(n);function n(){var t;(0,c.Z)(this,n);for(var r=arguments.length,i=new Array(r),l=0;l<r;l++)i[l]=arguments[l];return t=e.call.apply(e,[this].concat(i)),(0,m.Z)((0,d.Z)(t),"monitorOperations",null),(0,m.Z)((0,d.Z)(t),"terminalId",(0,g.x0)()),(0,m.Z)((0,d.Z)(t),"vmPassword",void 0),(0,m.Z)((0,d.Z)(t),"pollTestResultOperation",(0,H.GN)()),(0,m.Z)((0,d.Z)(t),"state",{instanceStatus:"",termKey:(0,g.x0)(),collapsed:"true"===G.rV("terminal_collapsed"),terminalActiveStatus:!1,terminalLoading:!1,tabIds:[(0,g.x0)()],activeTab:null,activeRequestId:null,testOutputExpanded:!1,testExecResult:null,testExecError:null,testExecInProgress:!1,outputHeight:0}),(0,m.Z)((0,d.Z)(t),"toggleCollapse",(function(){var e=t.state.collapsed;G.LS("terminal_collapsed",!e),t.setState({collapsed:!e})})),(0,m.Z)((0,d.Z)(t),"componentDidUpdate",(function(e){var n,r,a,i=null===e||void 0===e||null===(n=e.docker)||void 0===n?void 0:n.envs,o=null===(r=t.props)||void 0===r||null===(a=r.docker)||void 0===a?void 0:a.envs;!e.bypassEnvCheck&&t.props.bypassEnvCheck&&(t.updateTerminal(),t.props.bypassCheckCallback(!1)),!b.equals(i,o)&&t.props.activeTermID&&t.state.terminalActiveStatus&&t.updateTerminal(),e.activeTermID!==t.props.activeTermID&&t.props.activeTermID&&t.terminalId!==t.props.activeTermID&&(t.state.terminalActiveStatus||t.state.terminalLoading)&&t.setState({tabIds:[t.state.tabIds[0]],activeTab:t.state.tabIds[0],terminalActiveStatus:!1,terminalLoading:!1,instanceStatus:""})})),(0,m.Z)((0,d.Z)(t),"launchLiveTerminal",(function(){var e,n;t.setState({tabIds:[t.state.tabIds[0]],activeTab:t.state.tabIds[0],terminalActiveStatus:!1,terminalLoading:!0});var r=h.operation({retries:4,minTimeout:1e3,factor:1}),a=t.props,i=a.collectionId,c=a.shotId,l=a.docker,d=a.userId,u=a.pageType,p=a.workType,v=a.isDraft,m=a.projectId,f=t.props.content,b=t.props.authorId;b=b||d;var g=l.container,x=l.envs,y=null===g||void 0===g?void 0:g.imageName,I=null===l||void 0===l||null===(e=l.container)||void 0===e||null===(n=e.liveInstance)||void 0===n?void 0:n.id,w={app_id:I,envs:x||[],ports:[],force_relaunch:!0,image_name:y||H.CF,start_script:f.startScript||"",default_terminal:!y};r.attempt((0,s.Z)(o().mark((function e(){var n,a,s,l;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,H.GR)({authorId:b,workId:i||c,workType:p||u,pageType:u,containerInfo:w,draft:v,pageId:m,forceRelaunch:!0});case 2:n=e.sent,a=n.instanceStatus,s=n.requestId,(l=n.vmPassword)&&(t.vmPassword=l),(0,H.vp)(a)?t.setState({terminalLoading:!1,terminalActiveStatus:!0,instanceStatus:H.bO.WAITING_FOR_DAEMON,activeRequestId:s},(function(){return t.monitorInternalDaemonStatus({instanceId:I,requestId:s},w)})):r.retry(!0)||t.setState({tabIds:[t.state.tabIds[0]],activeTab:t.state.tabIds[0],terminalLoading:!1,instanceStatus:H.bO.ALLOCATION_FAILED});case 8:case"end":return e.stop()}}),e)}))))})),(0,m.Z)((0,d.Z)(t),"updateStartScript",(function(e){t.props.updateContentState({startScript:e})})),(0,m.Z)((0,d.Z)(t),"updateTerminal",(function(e){var n;if(e&&(e.preventDefault(),e.stopPropagation()),!t.props.bypassEnvCheck&&(null===(n=t.props.config)||void 0===n||!n.inEditor)){var r=t.props,a=r.docker,i=r.content.selectedEnvVars,o=void 0===i?{}:i,s=(0,tt.t)(a,o);if(s.length)return t.props.renderReplacementWrapper(s,!0)}t.launchLiveTerminal(),t.props.dispatch(I.x.connect(t.terminalId));var c=(0,g.x0)();t.setState({tabIds:[c],activeTab:c,instanceStatus:""})})),(0,m.Z)((0,d.Z)(t),"onDeactivateTerminal",(function(e){var n=t.state.tabIds.indexOf(e);-1!==n&&(n?t.onTabClose(e,n):t.setState({terminalActiveStatus:!1}))})),(0,m.Z)((0,d.Z)(t),"onReconnectedWebsocket",(function(e){-1!==t.state.tabIds.indexOf(e)&&t.props.activeTermID===t.terminalId&&t.setState({terminalActiveStatus:!0})})),(0,m.Z)((0,d.Z)(t),"componentWillUnmount",(function(){t.pollTestResultOperation.stop(),t.monitorOperations&&t.monitorOperations.stop(),t.props.isProject&&U.ZP.remove(t.bindProjectListener)})),(0,m.Z)((0,d.Z)(t),"handleEnvVarSelection",(function(e){t.props.updateContentState({selectedEnvVars:e})})),(0,m.Z)((0,d.Z)(t),"onTabAdd",(function(){var e=(0,g.x0)();t.setState({tabIds:[].concat((0,a.Z)(t.state.tabIds),[e]),activeTab:e})})),(0,m.Z)((0,d.Z)(t),"onTabChange",(function(e){t.setState({activeTab:e})})),(0,m.Z)((0,d.Z)(t),"onTabClose",(function(e,n){var r=t.state.tabIds.indexOf(t.state.activeTab);t.setState({tabIds:t.state.tabIds.filter((function(t){return e!==t}))},(function(){r>=n&&t.setState({activeTab:0===r?t.state.tabIds[0]:t.state.tabIds[r-1]})}))})),(0,m.Z)((0,d.Z)(t),"bindProjectListener",function(){var e=(0,s.Z)(o().mark((function e(n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.detail.event!==U.lx.TEST){e.next=4;break}return e.next=4,t.onLiveTestClicked();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),(0,m.Z)((0,d.Z)(t),"onLiveTestResult",function(){var e=(0,s.Z)(o().mark((function e(n){var r,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=n.results,a=n.error,t.setState({testExecInProgress:!1,testExecResult:r,testExecError:a});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),(0,m.Z)((0,d.Z)(t),"updateAssessmentProgress",(0,s.Z)(o().mark((function e(){var n,r,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.props.config.inEditor,r=t.props.question.progress,-1===(null===r||void 0===r?void 0:r.unsolved.indexOf(t.props.pageId))||n||(i=r.unsolved.filter((function(e){return e!==t.props.pageId})),t.props.dispatch(at.Ol.updateProgress({solved:[].concat((0,a.Z)(r.solved),[t.props.pageId]),unsolved:i})));case 4:case"end":return e.stop()}}),e)})))),(0,m.Z)((0,d.Z)(t),"onLiveTestClicked",(0,s.Z)(o().mark((function e(){var n,r,a,i,s,c,l,d,u,p,v,m,f,h,b,g,x,y;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.setState((function(t){return ot(ot({},t),{},{testOutputExpanded:!0,testExecResult:null,testExecError:null,testExecInProgress:!0,outputHeight:q.UN})})),c=t.props,l=c.authorId,d=c.collectionId,u=c.pageType,p=c.pageId,v=c.docker,m=c.testingDocker,f=t.props.config.inEditor,h=t.props.isProject?t.props.projectId:t.props.assessmentId,b={app_id:null===v||void 0===v||null===(n=v.container)||void 0===n||null===(r=n.liveInstance)||void 0===r?void 0:r.id,image_name:null===m||void 0===m||null===(a=m.container)||void 0===a?void 0:a.imageName,test_job:null===(i=t.props.content)||void 0===i||null===(s=i.dockerRunner)||void 0===s?void 0:s.testScript,envs:(null===m||void 0===m?void 0:m.envs)||[]},e.next=7,(0,H.s$)({authorId:l,pageId:p,containerInfo:b,inEditor:f,workId:d,documentType:u,docId:h});case 7:if(g=e.sent,x=g.testingContainerStatus,y=g.attemptCount,x!==H.bO.ALLOCATION_FAILED){e.next=13;break}return t.setState({testExecInProgress:!1,testExecError:"Couldn't run the tests. Make sure to run your code once before testing."}),e.abrupt("return");case 13:(0,H.m_)({authorId:l,collectionId:d,pageId:p,pageType:u,attemptCount:y,docId:h,inEditor:f},t.pollTestResultOperation,t.onLiveTestResult,t.updateAssessmentProgress);case 14:case"end":return e.stop()}}),e)})))),(0,m.Z)((0,d.Z)(t),"handleDockerRunnerChanged",(function(e){t.props.updateContentState({dockerRunner:e})})),t}return(0,l.Z)(n,[{key:"componentDidMount",value:function(){this.setState({activeTab:this.state.tabIds[0]}),this.props.isProject&&U.ZP.add(this.bindProjectListener)}},{key:"monitorInternalDaemonStatus",value:function(){var t=(0,s.Z)(o().mark((function t(e,n){var r,a,i=this;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=e.instanceId,a=e.requestId,this.monitorOperations=h.operation({retries:10,minTimeout:2e3,factor:1}),this.monitorOperations.attempt((0,s.Z)(o().mark((function t(){var e,s;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i.props.activeTermID===i.terminalId){t.next=4;break}return i.setState({tabIds:[i.state.tabIds[0]],terminalActiveStatus:!1,terminalLoading:!1,instanceStatus:""}),i.monitorOperations.stop(),t.abrupt("return");case 4:return t.next=6,(0,H.oN)({instanceId:r,requestId:a});case 6:e=t.sent,s=e.instanceStatus,(0,H.kl)(s)?"shot"===i.props.pageType?i.setState({instanceStatus:H.bO.RUNNING}):i.setState({instanceStatus:H.bO.UPDATING},(function(){return i.downloadResourceFile(n)})):i.monitorOperations.retry(!0)||i.setState({instanceStatus:H.bO.DAEMON_FAILED});case 9:case"end":return t.stop()}}),t)}))));case 3:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"downloadResourceFile",value:function(){var t=(0,s.Z)(o().mark((function t(e){var n,r,a,i,c,l,d,u,p,v,m,f,b,g,x=this;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=h.operation({retries:4,minTimeout:1e3,factor:1}),r={instance_id:e.app_id,container_image_name:e.image_name,envs:e.envs,ports:e.ports,run_script:"echo Hello World"},a=this.props,i=a.authorId,c=a.userId,l=a.isDraft,d=a.pageType,u=a.collectionId,p=a.workType,v=a.compId,m=a.shotId,f=a.pageId,b={language:"bash",source_code:"terminal",additional_files:[],entry_filename:"foo",author_id:i||c,work_id:u||m,work_type:p||d,page_id:f,is_draft_page:l,docker_container:JSON.stringify(r),comp_id:v},g=function(){var t=(0,s.Z)(o().mark((function t(){var e,n;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.t0=JSON,t.next=4,(0,rt.r0)(b);case 4:return t.t1=t.sent,e=t.t0.parse.call(t.t0,t.t1),n=e.status,t.abrupt("return",n);case 10:return t.prev=10,t.t2=t.catch(0),t.abrupt("return",-1);case 13:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(){return t.apply(this,arguments)}}(),n.attempt((0,s.Z)(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g();case 2:0===t.sent?x.setState({instanceStatus:H.bO.RUNNING}):n.retry(!0)||x.setState({instanceStatus:H.bO.UPDATE_FAILED});case 4:case"end":return t.stop()}}),t)}))));case 6:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"render",value:function(){var t,e,n,a,i=this,o=this.props,s=o.docker,c=o.testingDocker,l=o.userId,d=o.content,u=o.mode,p=o.takeFullView,v=d.selectedEnvVars,m=void 0===v?{}:v,f=this.state,h=f.instanceStatus,b=f.collapsed,g=f.terminalActiveStatus,x=f.terminalLoading,y=f.tabIds,I=f.activeTab,w=f.activeRequestId,k=null===s||void 0===s||null===(t=s.container)||void 0===t||null===(e=t.liveInstance)||void 0===e?void 0:e.url,T=!(null===(n=this.props)||void 0===n||!n.assessmentId),S=this.props.isProject||T,C=this.props.isProject&&"edit"!==u,Z=C?this.props.adjustHeight+this.state.outputHeight:this.props.adjustHeight;return(0,r.jsxs)("div",{className:"edcomp-toolbar ".concat(p?"w-full h-full":""),children:[(0,r.jsx)(nt,{mode:u,terminalActiveStatus:g,terminalLoading:x,startScript:d.startScript||"",onScriptChange:this.updateStartScript,onUpdateClicked:this.updateTerminal,onCollapse:this.toggleCollapse,onRelaunch:this.updateTerminal,collapsed:b,envs:s.envs,enableTesting:S,testingDocker:c,selectedDockerRunner:d.dockerRunner,onDockerRunnerChanged:this.handleDockerRunnerChanged,selectedEnvVars:m,widgetVersion:parseFloat(null===(a=this.props.content)||void 0===a?void 0:a.version),handleEnvVarSelection:this.handleEnvVarSelection,tabIds:y,activeTab:I,onTabAdd:this.onTabAdd,onTabChange:this.onTabChange,onTabClose:this.onTabClose}),this.props.inView&&y.map((function(t){var e,n,a;return(0,r.jsx)(ct,{terminalActiveStatus:g,terminalLoading:x,activeRequestId:w,activeInstanceId:null===(e=i.props.docker)||void 0===e||null===(n=e.container)||void 0===n||null===(a=n.liveInstance)||void 0===a?void 0:a.id,collapsed:b||I!==t,serverUrl:k,startScript:d.startScript||"",termId:t,isWidget:!0,instanceStatus:h,userId:l,onActivateTerminal:i.updateTerminal,onTerminalClose:i.onDeactivateTerminal,onReconnectedWebsocket:i.onReconnectedWebsocket,allowLoggedOutExecutions:i.props.allowLoggedOutExecutions,takeFullHeight:p,adjustHeight:Z,vmPassword:i.vmPassword},t)})),d.dockerRunner&&!C&&(0,r.jsx)("div",{className:"flex m-4",children:(0,r.jsx)(W.Z,{onClick:this.onLiveTestClicked,executionDisabled:!1})}),this.state.testOutputExpanded&&(0,r.jsx)(N,{outputVisible:this.state.testOutputExpanded,children:(0,r.jsxs)(R,{children:[(0,r.jsx)(A,{children:(0,r.jsx)(D,{children:"Test Results"})}),(0,r.jsx)(L,{children:(0,r.jsx)(F.Z,{inProgress:this.state.testExecInProgress,result:this.state.testExecResult,error:this.state.testExecError})})]})})]})}}],[{key:"getComponentDefault",value:function(){return{version:1}}}]),n}(f.Component);(0,m.Z)(dt,"defaultProps",{userId:null,renderReplacementWrapper:function(){},bypassEnvCheck:!1,takeFullView:!1,adjustHeight:0});var ut=lt(dt)}}]);
//# sourceMappingURL=2739-31cd32d80d4877b846d8.js.map